XCrypto=function(){var bm=sofo.utils||{};var bn=sofo.crypto||{};var b=sofo.pki||{};var aA=sofo.storage||{};var bU=sofo.cmp||{};var ae=sofo.error||{};var X=sofo.xfs||{};var E=sofo.anypin||{};var a4=sofo.xcs||{};var bB=window.console||{log:function(){}};aA.setSecureID("AnySignLiteXCrypto");var V=2e3;var l=2100;var r=2200;var Y=2300;var bH=2400;var s=2592e3;var a1=0;var bM=5;var I=0;var bz=20;var aP=24;var h=0;var v=1;var k=2;var aW="";var aG="";var aH={osName:"",osVersion:"",browserName:"",browserVersion:"",deviceType:""};var x={enable:false,desktop:false,mobile:false};var K={enable:false,desktop:false,mobile:false,cert:null};var L={enable:false,desktop:false,mobile:false};var bN="anysignlite";var y="anypin";var aD="anycertrelay";var a0="anypin_servercert";var bx="desktop";var u="mobile";var aI=false;var ai=0;var i=1;var bO=ai;function au(){if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4))){aG=u}else{aG=bx}if(forge.UAParser){var b7=new forge.UAParser;aH.osName=b7.getOS().name;aH.osVersion=b7.getOS().version;aH.browserName=b7.getBrowser().name;aH.browserVersion=b7.getBrowser().version;aH.deviceType=aG}}function b0(){if(!aG){au()}if(aG==u){return true}else{return false}}function am(){if(!aG){au()}if(!aH.osName||!aH.osVersion||!aH.browserName||!aH.browserVersion||!aH.deviceType){w(ae.INTERFACE_GETDEVICEINFO+ae.ERROR_API_FAIL);return""}return aH.osName+"|"+aH.osVersion+"|"+aH.browserName+"|"+aH.browserVersion+"|"+aH.deviceType}function bG(b7){if(b7){if(typeof b7==="number"){if(b7==i){bO=i}else{bO=ai}}else{if(typeof b7==="string"&&b7.toLowerCase()=="en-us"){bO=i}else{bO=ai}}}else{bO=ai}}var aF="utf-8";var q="euc-kr";var at=aF;function C(b7){if(b7){if(typeof b7==="number"){if(b7==1){at=q}else{at=aF}}else{if(typeof b7==="string"&&b7.toLowerCase()==q){at=q}else{at=aF}}}else{at=q}}var bF="";var aa="";var aj=[];var an={};var bR={};forge.pki.oids["1.3.6.1.5.5.7.48.1"]="ocsp";forge.pki.oids["ocsp"]="1.3.6.1.5.5.7.48.1";forge.pki.oids["1.2.410.200004.10.1.1"]="kisa-identifyData";forge.pki.oids["kisa-identifyData"]="1.2.410.200004.10.1.1";var aR=[];aR["yessignCA"]="금융결제원";aR["yessignCA Class 1"]="금융결제원";aR["yessignCA Class 2"]="금융결제원";aR["yessignCA Class 3"]="금융결제원";aR["SignKorea CA"]="코스콤(증권전산)";aR["SignKorea CA2"]="코스콤(증권전산)";aR["SignKorea CA3"]="코스콤(증권전산)";aR["SignKorea CA4"]="코스콤(증권전산)";aR["signGATE CA"]="한국정보인증(SignGATE)";aR["signGATE CA2"]="한국정보인증(SignGATE)";aR["signGATE CA4"]="한국정보인증(SignGATE)";aR["signGATE CA5"]="한국정보인증(SignGATE)";aR["signGATE CA6"]="한국정보인증(SignGATE)";aR["CrossCert Certificate Authority"]="한국전자인증";aR["CrossCertCA"]="한국전자인증";aR["CrossCertCA2"]="한국전자인증";aR["CrossCertCA3"]="한국전자인증";aR["CrossCertCA4"]="한국전자인증";aR["TradeSignCA"]="한국무역정보통신";aR["TradeSignCA2"]="한국무역정보통신";aR["TradeSignCA3"]="한국무역정보통신";aR["TradeSignCA4"]="한국무역정보통신";aR["NCASign CA"]="한국전산원";aR["CertRSA01"]="한국정보보호진흥원(KISA)";aR["KISA RootCA 1"]="한국정보보호진흥원(KISA)";aR["KISA RootCA 4"]="한국정보보호진흥원(KISA)";aR["CA131100001"]="행정자치부";aR["CA131100002"]="교육부";aR["CA128000031"]="대검찰청";aR["CA128000032"]="대검찰청";aR["CA974000031"]="대법원";aR["CA130000031"]="병무청";aR["INIPASS CA"]="이니텍(주)";var br=[];var B="일반인증서";var H=[];H["1.2.410.200004.2.1"]="공인인증기관";H["2.5.29.32.0"]="공인인증기관";H["1.2.410.100001.2.2.1"]="공인인증기관";H["1.2.410.100001.2.1.1,1.2.410.100001.2.1.2"]="공인인증기관";H["1.2.410.100001.2.1.1,1.2.410.100001.2.1.2,1.2.410.100001.2.2.1"]="공인인증기관";H["1.2.410.200005.1.1.1"]="범용개인";H["1.2.410.200005.1.1.2"]="은행기업";H["1.2.410.200005.1.1.4"]="은행개인";H["1.2.410.200005.1.1.5"]="범용기업";H["1.2.410.200005.1.1.6"]="용도제한용";H["1.2.410.200005.1.1.6.1"]="기업뱅킹";H["1.2.410.200005.1.1.6.2"]="신용카드";H["1.2.410.200004.5.1.1.1"]="스페셜 개인";H["1.2.410.200004.5.1.1.2"]="스페셜 개인서버";H["1.2.410.200004.5.1.1.3"]="스페셜 법인";H["1.2.410.200004.5.1.1.4"]="스페셜 서버";H["1.2.410.200004.5.1.1.5"]="범용개인";H["1.2.410.200004.5.1.1.6"]="범용 개인서버";H["1.2.410.200004.5.1.1.7"]="범용기업";H["1.2.410.200004.5.1.1.8"]="범용 서버";H["1.2.410.200004.5.1.1.9"]="증권/보험용";H["1.2.410.200004.5.1.1.9.2"]="신용카드";H["1.2.410.200004.5.1.1.10"]="골드 개인서버";H["1.2.410.200004.5.1.1.11"]="실버 개인";H["1.2.410.200004.5.1.1.12"]="실버 법인";H["1.2.410.200004.2.1,1.2.410.200012.1.1.1"]="전자거래 서명용(개인)";H["1.2.410.200004.2.1,1.2.410.200012.1.1.2"]="전자거래 암호용(개인)";H["1.2.410.200004.2.1,1.2.410.200012.1.1.3"]="전자거래 서명용(법인)";H["1.2.410.200004.2.1,1.2.410.200012.1.1.4"]="전자거래 암호용(법인)";H["1.2.410.200004.2.1,1.2.410.200012.1.1.5"]="전자거래 서명용(서버)";H["1.2.410.200004.2.1,1.2.410.200012.1.1.6"]="전자거래 암호용(서버)";H["1.2.410.200004.2.1,1.2.410.200012.1.1.7"]="전자무역 서명용(개인)";H["1.2.410.200004.2.1,1.2.410.200012.1.1.8"]="전자무역 암호용(개인)";H["1.2.410.200004.2.1,1.2.410.200012.1.1.9"]="전자무역 서명용(법인)";H["1.2.410.200004.2.1,1.2.410.200012.1.1.10"]="전자무역 암호용(법인)";H["1.2.410.200004.2.1,1.2.410.200012.1.1.11"]="전자무역 서명용(서버)";H["1.2.410.200004.2.1,1.2.410.200012.1.1.12"]="전자무역 암호용(서버)";H["1.2.410.200004.2.1,1.2.410.200012.1.1.101"]="은행/보험용";H["1.2.410.200004.2.1,1.2.410.200012.1.1.103"]="증권/보험용";H["1.2.410.200004.2.1,1.2.410.200012.1.1.105"]="신용카드용";H["1.2.410.200004.5.4.1.1"]="범용개인";H["1.2.410.200004.5.4.1.2"]="범용기업";H["1.2.410.200004.5.4.1.3"]="범용(서버)";H["1.2.410.200004.5.4.1.4"]="특수목적용(개인)";H["1.2.410.200004.5.4.1.5"]="특수목적용(법인)";H["1.2.410.200004.5.4.1.101"]="은행개인";H["1.2.410.200004.5.4.1.102"]="증권거래용";H["1.2.410.200004.5.4.1.103"]="신용카드";H["1.2.410.200004.5.4.1.104"]="전자민원용";H["1.2.410.200004.5.2.1.1"]="범용기업";H["1.2.410.200004.5.2.1.2"]="범용개인";H["1.2.410.200004.5.2.1.3"]="특별등급(전자입찰)";H["1.2.410.200004.5.2.1.4"]="1등급인증서(서버)";H["1.2.410.200004.5.2.1.5"]="특별등급 법인";H["1.2.410.200004.5.2.1.7.1"]="은행개인";H["1.2.410.200004.5.2.1.7.2"]="증권/보험용";H["1.2.410.200004.5.2.1.7.3"]="신용카드";H["1.2.410.200004.5.3.1.1"]="범용기업";H["1.2.410.200004.5.3.1.2"]="범용기업";H["1.2.410.200004.5.3.1.3"]="1등급(서버)";H["1.2.410.200004.5.3.1.5"]="특수목적용(기관/단체)";H["1.2.410.200004.5.3.1.6"]="특수목적용(법인)";H["1.2.410.200004.5.3.1.7"]="특수목적용(서버)";H["1.2.410.200004.5.3.1.8"]="특수목적용(개인)";H["1.2.410.200004.5.3.1.9"]="범용개인";H["1.2.410.200012.1.1.1"]="범용개인";H["1.2.410.200012.1.1.3"]="범용기업";H["1.2.410.200012.1.1.101"]="은행개인";H["1.2.410.200012.1.1.105"]="신용카드";H["1.2.410.200004.5.5.1.1"]="범용(개인)";H["1.2.410.200004.5.5.1.2"]="범용(기업)";H["1.2.410.200004.5.5.1.3.1"]="제휴기관용(개인)";H["1.2.410.200004.5.5.1.4.1"]="제휴기관용(기업)";H["1.2.410.200004.5.5.1.4.2"]="전자세금용(기업)";var A="Common";var c=[];c["1.2.410.200004.2.1"]="National";c["2.5.29.32.0"]="National";c["1.2.410.100001.2.2.1"]="National";c["1.2.410.100001.2.1.1,1.2.410.100001.2.1.2"]="National";c["1.2.410.100001.2.1.1,1.2.410.100001.2.1.2,1.2.410.100001.2.2.1"]="National";c["1.2.410.200005.1.1.1"]="Financial";c["1.2.410.200005.1.1.2"]="Financial";c["1.2.410.200005.1.1.4"]="Financial";c["1.2.410.200005.1.1.5"]="Commercial";c["1.2.410.200005.1.1.6"]="National";c["1.2.410.200005.1.1.6.1"]="Financial";c["1.2.410.200005.1.1.6.2"]="Financial";c["1.2.410.200004.5.1.1.1"]="National";c["1.2.410.200004.5.1.1.2"]="National";c["1.2.410.200004.5.1.1.3"]="National";c["1.2.410.200004.5.1.1.4"]="National";c["1.2.410.200004.5.1.1.5"]="Commercial";c["1.2.410.200004.5.1.1.6"]="Commercial";c["1.2.410.200004.5.1.1.7"]="Commercial";c["1.2.410.200004.5.1.1.8"]="Commercial";c["1.2.410.200004.5.1.1.9"]="Financial";c["1.2.410.200004.5.1.1.9.2"]="Financial";c["1.2.410.200004.5.1.1.10"]="National";c["1.2.410.200004.5.1.1.11"]="National";c["1.2.410.200004.5.1.1.12"]="National";c["1.2.410.200004.2.1,1.2.410.200012.1.1.1"]="National";c["1.2.410.200004.2.1,1.2.410.200012.1.1.2"]="National";c["1.2.410.200004.2.1.1.2.410.200012.1.1.3"]="National";c["1.2.410.200004.2.1,1.2.410.200012.1.1.4"]="National";c["1.2.410.200004.2.1,1.2.410.200012.1.1.5"]="National";c["1.2.410.200004.2.1,1.2.410.200012.1.1.6"]="National";c["1.2.410.200004.2.1,1.2.410.200012.1.1.7"]="Commercial";c["1.2.410.200004.2.1,1.2.410.200012.1.1.8"]="Commercial";c["1.2.410.200004.2.1,1.2.410.200012.1.1.9"]="Commercial";c["1.2.410.200004.2.1,1.2.410.200012.1.1.10"]="Commercial";c["1.2.410.200004.2.1,1.2.410.200012.1.1.11"]="Commercial";c["1.2.410.200004.2.1,1.2.410.200012.1.1.12"]="Commercial";c["1.2.410.200004.2.1,1.2.410.200012.1.1.101"]="Financial";c["1.2.410.200004.2.1,1.2.410.200012.1.1.103"]="Financial";c["1.2.410.200004.2.1,1.2.410.200012.1.1.105"]="Financial";c["1.2.410.200004.5.4.1.1"]="Commercial";c["1.2.410.200004.5.4.1.2"]="Commercial";c["1.2.410.200004.5.4.1.3"]="Commercial";c["1.2.410.200004.5.4.1.4"]="National";c["1.2.410.200004.5.4.1.5"]="National";c["1.2.410.200004.5.4.1.101"]="Financial";c["1.2.410.200004.5.4.1.102"]="Financial";c["1.2.410.200004.5.4.1.103"]="Financial";c["1.2.410.200004.5.4.1.104"]="National";c["1.2.410.200004.5.2.1.1"]="National";c["1.2.410.200004.5.2.1.2"]="National";c["1.2.410.200004.5.2.1.3"]="National";c["1.2.410.200004.5.2.1.4"]="National";c["1.2.410.200004.5.2.1.5"]="National";c["1.2.410.200004.5.2.1.7.1"]="Financial";c["1.2.410.200004.5.2.1.7.2"]="Financial";c["1.2.410.200004.5.2.1.7.3"]="Financial";c["1.2.410.200004.5.3.1.1"]="National";c["1.2.410.200004.5.3.1.2"]="National";c["1.2.410.200004.5.3.1.3"]="National";c["1.2.410.200004.5.3.1.5"]="National";c["1.2.410.200004.5.3.1.6"]="National";c["1.2.410.200004.5.3.1.7"]="National";c["1.2.410.200004.5.3.1.8"]="National";c["1.2.410.200004.5.3.1.9"]="National";c["1.2.410.200012.1.1.1"]="National";c["1.2.410.200012.1.1.3"]="National";c["1.2.410.200012.1.1.101"]="Financial";c["1.2.410.200012.1.1.105"]="Financial";c["1.2.410.200004.5.5.1.1"]="National";c["1.2.410.200004.5.5.1.2"]="Commercial";c["1.2.410.200004.5.5.1.3.1"]="National";c["1.2.410.200004.5.5.1.4.1"]="Commercial";c["1.2.410.200004.5.5.1.4.2"]="Commercial";var ba=[];var av=1;ba[av]={msg_koKR:"이미 동일한 인증서가 저장되어 있습니다.\n기존의 인증서를 삭제하고 이 인증서를 저장하시겠습니까?",msg_enUS:"Already the same certificate has been saved.\nDo you want to delete the existing certificate and save this certificate?"};function o(b8){var b7;if(bO==ai){b7=ba[b8].msg_koKR}else{b7=ba[b8].msg_enUS}return confirm(b7)}function ak(){try{if(!sofo||!sofo.utils||!sofo.crypto||!sofo.pki||!sofo.storage||!sofo.error||!sofo.cmp||!sofo.xfs){return-1}if(!window.localStorage||typeof localStorage=="undefined"){return-2}if(!window.FileReader||typeof FileReader=="undefined"){return-3}}catch(b7){return-4}return 0}function b1(ca,b8,b7){var b9=function(cb){if(cb!=0){a9(ae.XCRYPTO_SOFO_STORAGE+ae.XCRYPTO_SOFO_STORAGE_SETCROSSSTORAGE)}if(b7){b7(cb)}else{return cb}};return aA.setCrossStorage(ca,b8,b9)}function bP(cc,cb,b8,b7,b9){var ca=function(cd){if(cd!==0){aI=false}else{aI=true}if(b9){b9(cd)}else{return cd}};return aA.setOpenStorage(cc,cb,b8,b7,ca)}function m(b9){var ca=b.verifySignedData(b9,"",0);if(!ca){return""}var b8="e=camaster@softforum.com,cn=Softforum Root Authority,o=Softforum Corporation,c=KR";if(b8!=W(ca.cert[0].issuer)){return""}var b7=ca.plain.substring(2,ca.plain.length-1);return b7}function W(b7){var b8=[];b7.attributes.forEach(function(b9){b8.push(b9.shortName.toLowerCase()+"="+b9.value)});return forge.util.decodeUtf8(b8.reverse().join(","))}function bL(ca,b9){var b7=0;var b8=(b9.getTime()-ca.getTime())/1e3;if(b8<0){b7=2}else{if(b8>s){b7=0}else{b7=1}}return b7}function Q(ca){var b8=[];if(!ca){return""}function b7(cc){if(!cc){return}if(cc.composed&&cc.value instanceof Array){for(var cb=0;cb<cc.value.length;cb++){if(cc.value[cb].value instanceof Array){b8.push(cc.value[cb].value)}else{b8.push(forge.util.bytesToHex(cc.value[cb].value))}}}}try{b7(forge.asn1.fromDer(ca.value));if(b8.length>0){return b8[0]}else{return""}}catch(b9){return""}}function a3(cc){var b8={policy:[],unotice:[],cps:[]};var b9=false;var cd=false;if(!cc){return b8}function cb(cg){if(cg.composed&&cg.value instanceof Array){for(var cf=0;cf<cg.value.length;cf++){cb(cg.value[cf])}}else{if(cg.tagClass==forge.asn1.Class.UNIVERSAL&&cg.type==forge.asn1.Type.OID){var ce=forge.asn1.derToOid(cg.value);if(ce=="1.3.6.1.5.5.7.2.2"){b9=true}else{if(ce=="1.3.6.1.5.5.7.2.1"){cd=true}else{b9=false;cd=false}}}else{if(b9){b8.unotice.push(cg.value)}else{if(cd){b8.cps.push(cg.value)}}b9=false;cd=false}}}function b7(cg){if(!cg){return}if(cg.composed&&cg.value instanceof Array){for(var cf=0;cf<cg.value.length;cf++){if(cg.value[cf].composed&&cg.value[cf].value instanceof Array){for(var ce=0;ce<cg.value[cf].value.length;ce++){if(cg.value[cf].value[ce].tagClass==forge.asn1.Class.UNIVERSAL&&cg.value[cf].value[ce].type==forge.asn1.Type.OID){b8.policy.push(forge.asn1.derToOid(cg.value[cf].value[ce].value))}else{cb(cg.value[cf].value[ce])}}}}}}try{b7(forge.asn1.fromDer(cc.value));return b8}catch(ca){return b8}}function b3(b8){var ch=[];var cg="digitalSignature";var cf="nonRepudiation";var ce="keyEncipherment";var cd="dataEncipherment";var cc="keyAgreement";var cb="keyCertSign";var ca="cRLSign";var b9="encipherOnly";var b7="decipherOnly";if(!b8){return""}if(b8.digitalSignature){ch.push(cg)}if(b8.nonRepudiation){ch.push(cf)}if(b8.keyEncipherment){ch.push(ce)}if(b8.dataEncipherment){ch.push(cd)}if(b8.keyAgreement){ch.push(cc)}if(b8.keyCertSign){ch.push(cb)}if(b8.cRLSign){ch.push(ca)}if(b8.encipherOnly){ch.push(b9)}if(b8.decipherOnly){ch.push(b7)}return ch}function J(b8){var b7="";if(!b8){return""}if(b8.cA){if("pathLenConstraint"in b8){b7="Subject Type=CA, Path Length Constraint="+b8.pathLenConstraint}else{b7="Subject Type=CA, Path Length Constraint=None"}}else{b7="Subject Type=End Entity"}return b7}function ar(ca){function b8(cf){if(!cf){return}if(cf.composed&&cf.value instanceof Array){for(var cd=0;cd<cf.value.length;cd++){if(cf.value[cd].tagClass==forge.asn1.Class.CONTEXT_SPECIFIC&&cf.value[cd].type==0){var ce="ON=";if(cf.value[cd].composed&&cf.value[cd].value instanceof Array){for(var cc=0;cc<cf.value[cd].value.length;cc++){if(cf.value[cd].value[cc].tagClass==forge.asn1.Class.UNIVERSAL&&cf.value[cd].value[cc].type==forge.asn1.Type.OID){var cg=forge.asn1.derToOid(cf.value[cd].value[cc].value);var cb=forge.pki.oids[cg]?forge.pki.oids[cg]:cg;if(cb.toLowerCase()=="kisa-identifyData".toLowerCase()){ce+="VID"}else{ce+=cb}ce+="="}else{ce+=forge.util.bytesToHex(forge.asn1.toDer(cf.value[cd].value[cc].value[0]).getBytes())}}}b7.push(ce)}else{if(cf.value[cd].tagClass==forge.asn1.Class.CONTEXT_SPECIFIC&&cf.value[cd].type==1){var ce="RN="}else{}}}}}var b7=[];if(!ca){return""}try{b8(forge.asn1.fromDer(ca.value));return b7}catch(b9){return""}}function a2(ca){function b8(cc){if(!cc){return""}if(cc.composed&&cc.value instanceof Array){for(var cb=0;cb<cc.value.length;cb++){b8(cc.value[cb])}return b7}else{b7.push(cc.value)}}var b7=[];if(!ca){return""}try{return b8(forge.asn1.fromDer(ca.value))}catch(b9){return""}}function aL(ca){function b8(cf){if(!cf){return}if(cf.composed&&cf.value instanceof Array){for(var ce=0;ce<cf.value.length;ce++){if(cf.value[ce].composed&&cf.value[ce].value instanceof Array){if(cf.value[ce].value.length==2){var cg=forge.asn1.derToOid(cf.value[ce].value[0].value);var cc=forge.pki.oids[cg]?forge.pki.oids[cg].toUpperCase():cg;b7.push(cc+":URL="+cf.value[ce].value[1].value)}else{var cb="";for(var cd=0;cd<cf.value[ce].value.length;cd++){if(cf.value[ce].value[cd].tagClass==forge.asn1.Class.UNIVERSAL&&cf.value[ce].value[cd].type==forge.asn1.Type.OID){var cg=forge.asn1.derToOid(cf.value[ce].value[cd].value);var cc=forge.pki.oids[cg]?forge.pki.oids[cg].toUpperCase():cg;if(cb){cb+=":"}cb+=cc}else{if(cb){cb+=":"}cb+=cf.value[ce].value[cd].value}}if(cb){b7.push(cb)}}}}}}var b7=[];if(!ca){return""}try{b8(forge.asn1.fromDer(ca.value));return b7}catch(b9){return""}}function by(cz,b7){if(b7==bM){if(!cz.status){cz.status=bL(new Date,new Date(cz.validity.notAfter))}var cj=cz.validity.notAfter.getFullYear();var cx=cz.validity.notAfter.getMonth()+1;var cw=cz.validity.notAfter.getDate();var cy=cj+"-"+(cx<10?"0"+cx:cx)+"-"+(cw<10?"0"+cw:cw);var ce=cz.subject.getField("OU");var b8=a3(cz.getExtension("certificatePolicies"));var cp="";var cb="";if(ce){if(ce.value=="personalB"||ce.value=="corporation4ECB"){cb="브라우저 인증서"}else{cb=Z(b8.policy)}}else{cb=Z(b8.policy)}var cp="";var cl=cz.issuer.getField("CN");if(cl){cp=n(forge.util.decodeUtf8(cl.value))}var b9=cz.status+"$"+cb+"$"+W(cz.subject)+"$"+cp+"$"+cy+"$"+W(cz.issuer)+"$"+cz.serialNumber+"\t\n";return b9}else{var cs=bL(new Date,new Date(cz.validity.notAfter));var cc=cz.validity.notBefore.getFullYear();var cv=cz.validity.notBefore.getMonth()+1;var cr=cz.validity.notBefore.getDate();var cf=cz.validity.notBefore.getHours();var ct=cz.validity.notBefore.getMinutes();var cn=cz.validity.notBefore.getSeconds();var cg=cc+"-"+(cv<10?"0"+cv:cv)+"-"+(cr<10?"0"+cr:cr)+" "+(cf<10?"0"+cf:cf)+":"+(ct<10?"0"+ct:ct)+":"+(cn<10?"0"+cn:cn);var ca=cz.validity.notAfter.getFullYear();var cu=cz.validity.notAfter.getMonth()+1;var co=cz.validity.notAfter.getDate();var cd=cz.validity.notAfter.getHours();var cq=cz.validity.notAfter.getMinutes();var cm=cz.validity.notAfter.getSeconds();var cy=ca+"-"+(cu<10?"0"+cu:cu)+"-"+(co<10?"0"+co:co)+" "+(cd<10?"0"+cd:cd)+":"+(cq<10?"0"+cq:cq)+":"+(cm<10?"0"+cm:cm);var b8=a3(cz.getExtension("certificatePolicies"));var ck=b8.policy;var ci=b8.cps;var ch=b8.unotice;var b9=cs+"$"+(cz.version+1)+"$"+cz.serialNumber+"$"+(forge.pki.oids[cz.signatureOid]?forge.pki.oids[cz.signatureOid]:cz.signatureOid)+"$"+W(cz.issuer)+"$"+cg+"$"+cy+"$"+W(cz.subject)+"$"+(cz.publicKey.kcdsa?"KCDSA":"RSA")+" ("+cz.publicKey.bit+" Bits)"+"$"+cz.publicKey.obj+"$"+(cz.signature?forge.util.bytesToHex(cz.signature):"")+"$"+Q(cz.getExtension("authorityKeyIdentifier"))+"$"+ck+"$"+b3(cz.getExtension("keyUsage"))+"$"+J(cz.getExtension("basicConstraints"))+"$"+ar(cz.getExtension("subjectAltName"))+"$"+"URL="+a2(cz.getExtension("cRLDistributionPoints"))+"$"+ch+"$"+ci+"$"+aL(cz.getExtension({id:"1.3.6.1.5.5.7.1.1"}))+"\t\n";return b9}}function aB(cx,b8){if(b8==bM){var cw=cx.notAfter.substring(0,10);var cs=bL(new Date,new Date(cw));var cn;if(cx.cloud==true){cs+=4}var cb="";if(cx.subject.toUpperCase().indexOf("OU=PERSONALB")>=0||cx.subject.toUpperCase().indexOf("OU=CORPORATION4ECB")>=0){cb="브라우저 인증서"}else{cb=Z(cx.policyOID)}var cp="";var ck=cx.issuer.split(",");cp=n(forge.util.decodeUtf8(ck[0].substring(3)));var cf=cx.fingerprint;var b9=cs+"$"+cb+"$"+cx.subject+"$"+cp+"$"+cw+"$"+cx.issuer+"$"+cf+"$"+cx.source+"\t\n";return b9}else{var cs=bL(new Date,new Date(cx.validity.notAfter));var cc=cx.validity.notBefore.getFullYear();var cv=cx.validity.notBefore.getMonth()+1;var cr=cx.validity.notBefore.getDate();var ce=cx.validity.notBefore.getHours();var ct=cx.validity.notBefore.getMinutes();var cm=cx.validity.notBefore.getSeconds();var cg=cc+"-"+(cv<10?"0"+cv:cv)+"-"+(cr<10?"0"+cr:cr)+" "+(ce<10?"0"+ce:ce)+":"+(ct<10?"0"+ct:ct)+":"+(cm<10?"0"+cm:cm);var ca=cx.validity.notAfter.getFullYear();var cu=cx.validity.notAfter.getMonth()+1;var co=cx.validity.notAfter.getDate();var cd=cx.validity.notAfter.getHours();var cq=cx.validity.notAfter.getMinutes();var cl=cx.validity.notAfter.getSeconds();var cw=ca+"-"+(cu<10?"0"+cu:cu)+"-"+(co<10?"0"+co:co)+" "+(cd<10?"0"+cd:cd)+":"+(cq<10?"0"+cq:cq)+":"+(cl<10?"0"+cl:cl);var b7=a3(cx.getExtension("certificatePolicies"));var cj=b7.policy;var ci=b7.cps;var ch=b7.unotice;var b9=cs+"$"+(cx.version+1)+"$"+cx.serialNumber+"$"+(forge.pki.oids[cx.signatureOid]?forge.pki.oids[cx.signatureOid]:cx.signatureOid)+"$"+W(cx.issuer)+"$"+cg+"$"+cw+"$"+W(cx.subject)+"$"+(cx.publicKey.kcdsa?"KCDSA":"RSA")+" ("+cx.publicKey.bit+" Bits)"+"$"+cx.publicKey.obj+"$"+(cx.signature?forge.util.bytesToHex(cx.signature):"")+"$"+Q(cx.getExtension("authorityKeyIdentifier"))+"$"+cj+"$"+b3(cx.getExtension("keyUsage"))+"$"+J(cx.getExtension("basicConstraints"))+"$"+ar(cx.getExtension("subjectAltName"))+"$"+"URL="+a2(cx.getExtension("cRLDistributionPoints"))+"$"+ch+"$"+ci+"$"+aL(cx.getExtension({id:"1.3.6.1.5.5.7.1.1"}))+"\t\n";return b9}}function b4(ch,b9,ce,cc,b7,cf){var cg=[];var b8;var cd;var cb=true;if(b7==2){cb=false;b7=0}var ca=function(cj){if(ch==V&&aI==true){if(cj==-1){cf(null)}else{cf(cj)}return}if(!cj||cj.length<=0){if(b7==1){cf(-1);return-1}else{cf(null);return null}}if(ch==l){b8=cj[0];cd=0}else{for(cd=0;cd<cj.length;++cd){if(W(cj[cd].signCert.issuer).toLowerCase().indexOf(b9.toLowerCase())>=0){if(cj[cd].signCert.serialNumber.toLowerCase()==ce.toLowerCase()){b8=cj[cd];break}}}}if(!b8){if(b7==1){cf(-1);return-1}else{cf(null);return null}}if(b7==1){cf(cd)}else{cf(b8)}};if(ch==V){if(aI==true){var ci=function(cj){if(cj==-5e3){aI=false;aA.getCertKeyList(null,ca)}else{ca(cj)}};aA.getCertKeyListOpenCertWithPassword(null,ce,cc,cb,ci)}else{aA.getCertKeyList(null,ca)}}else{if(ch==r){aA.getCertKeyList("session",ca)}else{if(ch==l){cg=aA.getMemCertKeyList();ca(cg)}else{if(ch==Y){cg=aA.getXfsCertKeyList();ca(cg)}}}}}function w(b7){ae.setError(b7)}function a9(b7){ae.addError(b7)}function bs(){ae.resetError()}function aU(){return ae.getError()}function M(){return ae.getError().code}function bT(){if(bO==ai){return ae.getError().msg_koKR?ae.getError().msg_koKR:ae.getError().internal}else{return ae.getError().msg_enUS?ae.getError().msg_enUS:ae.getError().internal}}function aw(){return ae.getError().internal}function b2(b7){b._setSecureInput(b7);X._setSecureInput(b7);aA._setSecureInput(b7);E._setSecureInput(b7)}function bJ(){return b._getSecureInput()}function n(b7){if(bO==ai){return aR[b7]?aR[b7]:b7}else{return br[b7]?br[b7]:b7}}function Z(b7){if(bO==ai){return H[b7]?H[b7]:B}else{return c[b7]?c[b7]:A}}function aV(b7,b9,b8,ca){if(ca==0){aR[b7]=b9}else{br[b7]=b9}return 0}function aE(b9,b8,b7,ca){if(ca==0){H[b9]=b8}else{c[b9]=b8}return 0}function bQ(b7,b8){var b9=function(ca){if(ca!=0){a9(ae.XCRYPTO_SOFO_STORAGE_SETLOCALSTORAGE)}b8(ca)};aA.setLocalStorage("lastLocation",b7,b9)}function bK(b7){aA.getLocalStorage("lastLocation",b7)}function ax(b8,b7){return b.generateRandom(b8)}function aZ(b7,b8){var b9=function(ca){if(ca!=0){a9(ae.XCRYPTO_SOFO_STORAGE_SETSESSIONSTORAGE)}b8(ca)};aA.setSessionStorage("cacheCertLocation",b7,0,b9)}function T(b7,b9){var b8=function(ca){if(ca==null||ca==""){b9(0)}else{if(b7=="undefined"||b7==null||b7==0){b9(parseInt(ca/100))}else{b9(ca)}}};aA.getSessionStorage("cacheCertLocation",0,b8)}function be(b7){if(aj.length>0){if(aj.indexOf(b7)>=0){return true}else{return false}}return false}function e(b8,ca,b9,b7,cd,cb){var cc;if(b8==l){cc=b.certificateToPKCS12(b7.signCert,b7.signKey,b7.kmCert,b7.kmKey,cd,cd,0);ca=null;b9=null}else{cc=null}var ce=function(cf){if(cf!=0){a9(ae.INTERFACE_SIGNDATA+ae.XCRYPTO_SOFO_STORAGE_SETCACHEDCERT)}cb(cf)};aA.setCachedCert(b8,ca,b9,cc,cd,b._getSecureInput(),ce)}function af(b7,b9){var b8=function(cd){if(cd){if(cd.mediaID!=b7){a9(ae.XCRYPTO_SOFO_STORAGE_GETCACHEDCERT);b9(null)}if(cd.secureInput){var cg=b._getSecureInput();if(cg){var ce=cd.secureInput.split("|");var ch=cg.split("$");var ca=false;for(var cf=0;cf<ch.length;cf++){var cc=ch[cf].split("|");if(cc[0]==ce[0]){ca=true}}if(!ca){cg+="$";cg+=cd.secureInput;b2(cg)}}else{b2(cd.secureInput)}}if(cd.mediaID==V){var cb=function(ci){cd.cert=ci;b9(cd)};b4(cd.mediaID,cd.issuerRDN,cd.serialNumber,cd.keyword,0,cb)}else{if(cd.mediaID==l){cd.cert=b.certificateFromPFX(cd.cert,cd.keyword);b9(cd)}else{a9(ae.XCRYPTO_SOFO_STORAGE_GETCACHEDCERT);b9(null)}}}else{a9(ae.XCRYPTO_SOFO_STORAGE_GETCACHEDCERT);b9(null)}};aA.getCachedCert(b8)}function G(b8,b7){var b9=function(ca){if(ca!=0){a9(ae.XCRYPTO_SOFO_STORAGE_SETSESSIONSTORAGE)}b7(ca)};aA.setSessionStorage("cachedData",b8,1,b9)}function aN(b7){return aA.getSessionStorage("cachedData",1,b7)}function F(b8){var b7=function(b9){if(b9==null||b9==""){b8(-1)}else{b8(0)}};aA.getSessionStorage("cachedData",0,b7)}function bg(b8){var b7=function(b9){if(b9==null||b9==""){b8(-1)}else{aA.deleteSessionStorage("cachedData",b8)}};aA.getSessionStorage("cachedData",0,b7)}function ac(cd){aW=cd;au();x.enable=false;x.desktop=false;x.mobile=false;K.enable=false;K.desktop=false;K.mobile=false;L.enable=false;L.desktop=false;L.mobile=false;var cc=b.verifySignedData(cd,"",0);if(!cc){w(ae.INTERFACE_SETLICENSE+ae.ERROR_SETLICENSE_FAIL);return-1}var b9="e=camaster@softforum.com,cn=Softforum Root Authority,o=Softforum Corporation,c=KR";if(b9!=W(cc.cert[0].issuer)){w(ae.INTERFACE_SETLICENSE+ae.ERROR_SETLICENSE_FAIL);return-1}var cb=window.location.hostname;if(window.location.port){cb+=":"+window.location.port}if(cc.plain.indexOf(cb)<0){w(ae.INTERFACE_SETLICENSE+ae.ERROR_SETLICENSE_FAIL);return-1}var b8=cc.plain.toLowerCase().split(",");for(var ca=0;ca<b8.length;ca++){if(b8[ca].indexOf(bN)>=0){x.enable=true;var b7=b8[ca].split("=");if(b7.length==2){if(b7[1]==bx){x.desktop=true}else{if(b7[1]==u){x.mobile=true}}}else{x.desktop=true;x.mobile=true}}if(b8[ca].indexOf(y)>=0){K.enable=true;var b7=b8[ca].split("=");if(b7.length==2){if(b7[1]==bx){K.desktop=true}else{if(b7[1]==u){K.mobile=true}}}else{K.desktop=true;K.mobile=true}}if(b8[ca].indexOf(aD)>=0){L.enable=true;var b7=b8[ca].split("=");if(b7.length==2){if(b7[1]==bx){L.desktop=true}else{if(b7[1]==u){L.mobile=true}}}else{L.desktop=true;L.mobile=true}}if(b8[ca].indexOf("anypin_servercert")>=0){var b7=b8[ca].split("=");if(b7.length==2){K.cert=b7[1];E.setLicense(K.cert)}}}return 0}function p(){return aW}function a5(){if(!aG){au()}if(x.enable){if(aG==bx&&x.desktop){return true}if(aG==u&&x.mobile){return true}}return false}function bh(){if(!aG){au()}if(K.enable){if(aG==bx&&K.desktop){return true}if(aG==u&&K.mobile){return true}}return false}function bi(){if(!aG){au()}if(L.enable){if(aG==bx&&L.desktop){return true}if(aG==u&&L.mobile){return true}}return false}function U(ca,cc){var b9=cc.toLowerCase().split(":");if(b9.length<2){w(ae.INTERFACE_SETSECURITYCONTEXT+ae.ERROR_INCORRECT_PARAM);return-1}var b7=Number(b9[0]);if(!(b7&512)){return 0}var b8=[];for(var ce=1;ce<b9.length;ce++){if(b9[ce]=="browser"){b8.push(V);b8.push(l)}}if(b8.length==0){return 0}var cg;var cf;if(b7&128){var cb=ca.split(";");if(cb.length<2){w(ae.INTERFACE_SETSECURITYCONTEXT+ae.ERROR_INCORRECT_PARAM);return-1}cg=cb[1];cf=cb[0]}else{cg=ca;cf=window.location.protocol+"//"+window.location.hostname+":"+(window.location.port?window.location.port:"80")}var ch=b.verifySignedData(cg,"",0);if(!ch){a9(ae.INTERFACE_SETSECURITYCONTEXT+ae.XCRYPTO_SOFO_PKI_VERIFYSIGNEDDATA);return-1}if(cf.indexOf(ch.plain)<0){w(ae.INTERFACE_SETSECURITYCONTEXT+ae.ERROR_GETPLAINDATAOFSIGNDATA);return-1}var cd="e=camaster@softforum.com,cn=Softforum Root Authority,o=Softforum Corporation,c=KR";if(cd!=W(ch.cert[0].issuer)){w(ae.INTERFACE_SETSECURITYCONTEXT+ae.ERROR_GETPLAINDATAOFSIGNDATA);return-1}bF=cg;aa=b7;aj=b8;return 0}function ap(ca,b9,b7){var cb=0;if(ca==l){aA.clearMemCertKeyList();if(b7){b7(0)}else{return 0}}else{if(ca==Y){aA.clearXfsCertKeyList();if(b7){var b8=function(cc){if(cc!=0){a9(ae.INTERFACE_GETMEDIALIST+ae.XCRYPTO_SOFO_XFS_USEREXTENSION)}b7(cc)};X.userExtension(b8)}else{cb=X.userExtension();if(cb!=0){a9(ae.INTERFACE_GETMEDIALIST+ae.XCRYPTO_SOFO_XFS_USEREXTENSION)}return cb}}else{if(!window.localStorage||typeof localStorage=="undefined"){cb=-1;w(ae.INTERFACE_GETMEDIALIST+ae.ERROR_NOT_SUPPORTED_MEDIA)}if(b7){b7(cb)}else{return cb}}}}function bp(cd,ch,cg,ce){var ci=[];var b8=[];var cj=false;var b9=false;if(typeof ch==="string"&&ch!=""){ci=ch.split(",")}if(typeof cg==="string"&&cg!=""){b8=cg.split(",")}if(ci.length>0&&ce!=I){if(ce==bz){for(var cc=0;cc<ci.length;++cc){var cb;var b7;if(aI==true&&typeof cd.issuer=="string"){var cf=cd.issuer.split(",");cb=cf[0].substring(3);if(cb){cb=forge.util.decodeUtf8(cb);if(ci[cc].indexOf(cb)>=0){if(ci[cc].indexOf(":")>=0){if(ci[cc].indexOf(cd.policyOID)>=0){cj=true;return cj}}else{cj=true;return cj}}}}else{cb=cd.issuer.getField("CN");if(cb){cb=forge.util.decodeUtf8(cb.value);var ca=ci[cc].split(":");if(ca[0]==cb){if(ci[cc].indexOf(":")>=0){b7=a3(cd.getExtension("certificatePolicies"));if(ci[cc].indexOf(b7.policy)>=0){cj=true;break}}else{cj=true;break}}}}}}else{if(ce==aP){if(W(cd.issuer).toLowerCase()==ch.toLowerCase()){cj=true}}}}else{cj=true}if(cj){if(b8.length>0){for(var cc=0;cc<b8.length;++cc){if(cd.serialNumber.toLowerCase()==b8[cc].toLowerCase()){b9=true;break}}}else{b9=true}}return b9}function bw(cj,b8,cb,cn,cf,ci){var ce=function(cp){var cs=[];if(!cp||cp.length==0||cp==-1){if(ci){ci("")}return""}var cu="";if(cj==V&&aI==true){if(cp.length==undefined){cu+=by(cp.signCert,cf)}else{if(cf==bM){for(var cq=0;cq<cp.length;cq++){if(bp(cp[cq],cb,cn,b8)){cu+=aB(cp[cq],cf)}}}else{if(cp==-1){if(ci){ci("")}return""}cu+=aB(cp.signCert,cf)}}}else{for(var cq=0;cq<cp.length;cq++){var co,ct=null;if(cj==Y&&cf==bM){co=cp[cq].cert;var cr,cv;if(!co){continue}else{if(co.charAt(0)=="3"){cv=forge.util.hexToBytes(co)}else{if(co.charAt(0)=="M"){cv=forge.util.decode64(co)}else{continue}}}cr=forge.asn1.fromDer(cv);co=forge.pki.certificateFromAsn1(cr);if(cp[cq].kmCert){if(cp[cq].kmCert.charAt(0)=="3"){cv=forge.util.hexToBytes(cp[cq].kmCert);cr=forge.asn1.fromDer(cv);ct=forge.pki.certificateFromAsn1(cr)}else{if(cp[cq].kmCert.charAt(0)=="M"){cv=forge.util.decode64(cp[cq].kmCert);cr=forge.asn1.fromDer(cv);ct=forge.pki.certificateFromAsn1(cr)}}}aA.saveXfsCertKey(co,null,ct,null);if(cp[cq].statusCode==201){if(cp[cq].expireMsg==203){co.status="0"}else{if(cp[cq].expireMsg==205){co.status="1"}else{if(cp[cq].expireMsg==204){co.status="2"}else{co.status="2"}}}}else{if(cp[cq].statusCode==202){co.status="3"}else{co.status="2"}}}else{co=cp[cq].signCert}if(bp(co,cb,cn,b8)){cs=cs.concat(co)}}for(var cq=0;cq<cs.length;cq++){cu+=by(cs[cq],cf)}}if(ci){ci(cu)}return cu};if(cj==V){if(aI==true){var cm=function(co){if(co==-5e3){aI=false;return aA.getCertKeyList(null,ce)}else{ce(co)}};if(cn.length==0){return aA.getCertKeyListOpenCert(null,cm)}else{return aA.getCertKeyListOpenCertWithPassword(null,cn,"",true,cm)}}else{return aA.getCertKeyList(null,ce)}}else{if(cj==r){return aA.getCertKeyList("session",ce)}else{if(cj==l){var ch=aA.getMemCertKeyList();return ce(ch)}else{if(cj==Y){if(cf==bM){if(ci){X.certList(ce)}else{var ch=X.certList();return ce(ch)}}else{var ch=aA.getXfsCertKeyList();return ce(ch)}}else{if(cj==bH){var ch=[];if(bR.type==0){if(!bR.certList){if(ci){ci("")}return""}var b7=JSON.parse(bR.certList);if(!b7||!b7.item||b7.item.length==0){if(ci){ci("")}return""}for(var cc=0;cc<b7.item.length;cc++){var ca=b7.item[cc].cert;var b9,cg;if(!ca){continue}else{if(ca.charAt(0)=="3"){cg=forge.util.hexToBytes(ca)}else{if(ca.charAt(0)=="M"){
cg=forge.util.decode64(ca)}else{continue}}}b9=forge.asn1.fromDer(cg);var cd={};cd.signCert=forge.pki.certificateFromAsn1(b9);ch.push(cd)}}else{var cl=document.getElementById(bR.storageElementID);if(!cl){if(ci){ci("")}return""}var ck=cl.getElementsByClassName("list");if(!ck||ck.length==0){if(ci){ci("")}return""}for(var cc=0;cc<ck.length;cc++){var ca=ck[cc].getAttribute("data-cert");var b9,cg;if(!ca){continue}else{if(ca.charAt(0)=="3"){cg=forge.util.hexToBytes(ca);b9=forge.asn1.fromDer(cg)}else{if(ca.charAt(0)=="M"){cg=forge.util.decode64(ca);b9=forge.asn1.fromDer(cg)}else{continue}}}var cd={};cd.signCert=forge.pki.certificateFromAsn1(b9);ch.push(cd)}}if(ch.length==0){if(ci){ci("")}return""}return ce(ch)}else{if(ci){ci("")}return""}}}}}}function bc(b7,b9,b8,cc,cb){var ca=function(cd){if(!cd){w(ae.INTERFACE_VERIFYCERT+ae.ERROR_GETCERTIFICATE);if(cb){cb(-1)}return-1}var ce=b.verifyCertificate(cd.signCert,cc);if(ce!=0&&ce!=1){a9(ae.INTERFACE_VERIFYCERT+ae.XCRYPTO_SOFO_PKI_VERIFYCERTIFICATE)}if(cb){cb(ce)}return ce};return b4(b7,b9,b8,"",2,ca)}function a7(b7,b9,b8,cc,cd,cb){var ca=function(ce){if(!ce){w(ae.INTERFACE_VERIFYCERTOWNER+ae.ERROR_GETCERTIFICATE);if(cb){cb(-1)}return-1}var cf=b.identifyVID(ce.signCert,ce.signKey,cc,cd);if(cf!=0){a9(ae.INTERFACE_VERIFYCERTOWNER+ae.XCRYPTO_SOFO_PKI_IDENTIFYVID)}if(cb){cb(cf)}return cf};return b4(b7,b9,b8,cc,2,ca)}function a8(b7,cb,b9,cd,b8){var cc=function(cf){if(!cf){if(M()==0){w(ae.INTERFACE_VERIFYCERTPWD+ae.ERROR_GETCERTIFICATE)}if(b8){b8(-1)}return-1}if(b.checkPrivateKey(cf.signKey,cd)!=0){if(M()==0){a9(ae.INTERFACE_VERIFYCERTPWD+ae.XCRYPTO_SOFO_PKI_CHECKPRIVATEKEY)}if(b8){b8(-1)}return-1}if(cf.kmCert&&cf.kmKey){if(b.checkPrivateKey(cf.kmKey,cd)!=0){if(M()==0){w(ae.INTERFACE_VERIFYCERTPWD+ae.ERROR_INCORRECT_PASSWORD_KMCERT)}if(b8){b8(-1)}return-1}}if(b8){b8(0)}return 0};if(b7==Y){if(b8){var ca=function(cf){if(cf!=0){a9(ae.INTERFACE_VERIFYCERTPWD+ae.XCRYPTO_SOFO_XFS_CERTPASSWORDCONFIRM)}b8(cf)};X.certPasswordConfirm(cb,b9,cd,ca)}else{var ce=X.certPasswordConfirm(cb,b9,cd);if(ce!=0){a9(ae.INTERFACE_VERIFYCERTPWD+ae.XCRYPTO_SOFO_XFS_CERTPASSWORDCONFIRM)}return ce}}else{return b4(b7,cb,b9,cd,2,cc)}}function t(b9,b7,b8){var ca;if(b8&2){if(b8&1){ca=b.checkKeyword2(b9,b7,1)}else{ca=b.checkKeyword2(b9,b7,0)}if(ca!=0){a9(ae.INTERFACE_CHECKPWD+ae.XCRYPTO_SOFO_PKI_CHECKKEYWORD2)}}else{if(b8&1){ca=b.checkKeyword(b9,b7,1)}else{ca=b.checkKeyword(b9,b7,0)}if(ca!=0){a9(ae.INTERFACE_CHECKPWD+ae.XCRYPTO_SOFO_PKI_CHECKKEYWORD)}}return ca}function aS(cg,b9,cb,b7,b8,ce,cc){var ca=function(ch){if(!ch){w(ae.INTERFACE_CHANGECERTPWD+ae.ERROR_GETCERTIFICATE);if(cc){cc(-1)}return-1}var cl=b.changeEncryptPrivateKey(ch.signKey,b7,b8);var ck=null;if(!cl){a9(ae.INTERFACE_CHANGECERTPWD+ae.XCRYPTO_SOFO_PKI_CHANGEENCRYPTPRIVATEKEY);if(cc){cc(-1)}return-1}if(ch.kmCert&&ch.kmKey){ck=b.changeEncryptPrivateKey(ch.kmKey,b7,b8);if(!ck){a9(ae.INTERFACE_CHANGECERTPWD+ae.XCRYPTO_SOFO_PKI_CHANGEENCRYPTPRIVATEKEY);if(cc){cc(-1)}return-1}}var ci=function(cm){if(cm>=0){if(cc){cc(0)}return 0}else{a9(ae.INTERFACE_CHANGECERTPWD+ae.XCRYPTO_SOFO_STORAGE_CHANGECERTPRIKEY);if(cc){cc(-1)}return-1}};if(cg==r){aA.changeCertPriKey(ch.signCert,cl,ch.kmCert,ck,"session",ci)}else{if(aI==true){var cj=function(cm){if(cm==-5e3){aI=false;aA.changeCertPriKey(ch.signCert,cl,ch.kmCert,ck,null,ci)}else{ci(cm)}};aA.changeOpenCertPriKey(ch.signCert,cl,ch.kmCert,ck,b7,b8,null,cj)}else{aA.changeCertPriKey(ch.signCert,cl,ch.kmCert,ck,null,ci)}}};if(cg==V){return b4(V,b9,cb,b7,0,ca)}else{if(cg==r){return b4(r,b9,cb,"",0,ca)}else{if(cg==Y){if(cc){var cd=function(ch){if(ch!=0){a9(ae.INTERFACE_CHANGECERTPWD+ae.XCRYPTO_SOFO_XFS_CERTPASSWORDUPDATE)}cc(ch)};X.certPasswordUpdate(b9,cb,b7,b8,ce,cd)}else{var cf=X.certPasswordUpdate(b9,cb,b7,b8,ce);if(cf!=0){a9(ae.INTERFACE_CHANGECERTPWD+ae.XCRYPTO_SOFO_XFS_CERTPASSWORDUPDATE)}return cf}}else{w(ae.INTERFACE_CHANGECERTPWD+ae.ERROR_INCORRECT_PARAM);if(cc){cc(-1)}return-1}}}}function ag(cd,b8,b9,ca){var b7=function(ch){if(ch<0){w(ae.INTERFACE_DELETECERT+ae.ERROR_GETCERTIFICATE);if(ca){ca(-1)}return-1}var cg=function(cj){if(cj==0){if(ca){ca(0)}return 0}else{a9(ae.INTERFACE_DELETECERT+ae.XCRYPTO_SOFO_STORAGE_DELETECERT);if(ca){ca(-1)}return-1}};if(cd==r){aA.deleteCert(ch,"session",cg)}else{if(aI==true){var ci=function(cj){if(cj==-5e3){aI=false;aA.deleteCert(ch,null,cg)}else{certListCallbackSecond(cj)}};aA.deleteOpenCert(ch,null,ci)}else{aA.deleteCert(ch,null,cg)}}};if(cd==V){if(aI==true){var ce=function(cg){if(cg==0){if(ca){ca(0)}return 0}else{a9(ae.INTERFACE_DELETECERT+ae.XCRYPTO_SOFO_STORAGE_DELETECERT);if(ca){ca(-1)}return-1}};var cf=function(cg){if(cg==-5e3){aI=false;return b4(V,b8,b9,"",1,b7)}else{ce(cg)}};aA.deleteOpenCertFromID(b9,null,cf)}else{return b4(V,b8,b9,"",1,b7)}}else{if(cd==r){return b4(r,b8,b9,"",1,b7)}else{if(cd==l){aA.clearMemCertKeyList();if(ca){ca(0)}return 0}else{if(cd==Y){if(ca){var cb=function(cg){if(cg!=0){a9(ae.INTERFACE_DELETECERT+ae.XCRYPTO_SOFO_XFS_CERTDELETE)}ca(cg)};X.certDelete(b8,b9,cb)}else{var cc=X.certDelete(b8,b9);if(cc!=0){a9(ae.INTERFACE_DELETECERT+ae.XCRYPTO_SOFO_XFS_CERTDELETE)}return cc}}else{w(ae.INTERFACE_DELETECERT+ae.ERROR_INCORRECT_PARAM);if(ca){ca(-1)}return-1}}}}}function b6(cf,b7,ci,cc,cg,b8,ca,cj,b9,ce){var cb=b.certificateFromDer(cf,b7,ci,cc,cg);if(!cb){a9(ae.INTERFACE_SETCERT+ae.XCRYPTO_SOFO_PKI_CERTIFICATEFROMDER);if(ce){ce(-1)}return-1}if(!bp(cb.signCert,ca,cj,b8)){w(ae.INTERFACE_SETCERT+ae.ERROR_USE_CERT_FAIL);if(ce){ce(-1)}return-1}aA.clearMemCertKeyList();aA.saveMemCertKey(cb.signCert,cb.signKey,cb.kmCert,cb.kmKey);if(b9&1){var cd=function(cm){if(cm==1){if(o(av)==true){var cl=function(cn){if(cn!=0){a9(ae.INTERFACE_SETCERT+ae.XCRYPTO_SOFO_STORAGE_SAVECERTKEY)}if(ce){ce(cn)}};if(aI==true){var ck=function(cn){if(cn==-5e3){aI=false;aA.saveCertKey(cb.signCert,cb.signKey,cb.kmCert,cb.kmKey,null,1,cl)}else{cl(cn)}};aA.saveOpenCertKey(cb.signCert,cb.signKey,cb.kmCert,cb.kmKey,cg,null,1,0,ck)}else{aA.saveCertKey(cb.signCert,cb.signKey,cb.kmCert,cb.kmKey,null,1,cl)}}else{if(ce){ce(1)}}}else{if(cm!=0){a9(ae.INTERFACE_SETCERT+ae.XCRYPTO_SOFO_STORAGE_SAVECERTKEY)}if(ce){ce(cm)}}};if(aI==true){var ch=function(ck){if(ck==-5e3){aI=false;aA.saveCertKey(cb.signCert,cb.signKey,cb.kmCert,cb.kmKey,null,0,cd)}else{cd(ck)}};aA.saveOpenCertKey(cb.signCert,cb.signKey,cb.kmCert,cb.kmKey,cg,null,0,0,ch)}else{aA.saveCertKey(cb.signCert,cb.signKey,cb.kmCert,cb.kmKey,null,0,cd)}}else{if(ce){ce(0)}return 0}}function ay(ce,cd,b7,b9,cg,b8,cc){var ca=b.certificateFromPFX(ce,cd);if(!ca){a9(ae.INTERFACE_SETCERT+ae.XCRYPTO_SOFO_PKI_CERTIFICATEFROMPFX);if(cc){cc(-1)}return-1}if(!bp(ca.signCert,b9,cg,b7)){w(ae.INTERFACE_SETCERT+ae.ERROR_USE_CERT_FAIL);if(cc){cc(-1)}return-1}aA.clearMemCertKeyList();aA.saveMemCertKey(ca.signCert,ca.signKey,ca.kmCert,ca.kmKey);if(b8&1){var cb=function(cj){if(cj==1){if(o(av)==true){var ci=function(ck){if(ck!=0){a9(ae.INTERFACE_SETCERT+ae.XCRYPTO_SOFO_STORAGE_SAVECERTKEY)}if(cc){cc(ck)}};if(aI==true){var ch=function(ck){if(ck==-5e3){aI=false;aA.saveCertKey(ca.signCert,ca.signKey,ca.kmCert,ca.kmKey,null,1,ci)}else{ci(ck)}};aA.saveOpenCertKey(ca.signCert,ca.signKey,ca.kmCert,ca.kmKey,cd,null,1,0,ch)}else{aA.saveCertKey(ca.signCert,ca.signKey,ca.kmCert,ca.kmKey,null,1,ci)}}else{if(cc){cc(1)}}}else{if(cj!=0){a9(ae.INTERFACE_SETCERT+ae.XCRYPTO_SOFO_STORAGE_SAVECERTKEY)}if(cc){cc(cj)}}};if(aI==true){var cf=function(ch){if(ch==-5e3){aI=false;aA.saveCertKey(ca.signCert,ca.signKey,ca.kmCert,ca.kmKey,null,0,cb)}else{cb(ch)}};aA.saveOpenCertKey(ca.signCert,ca.signKey,ca.kmCert,ca.kmKey,cd,null,0,0,cf)}else{aA.saveCertKey(ca.signCert,ca.signKey,ca.kmCert,ca.kmKey,null,0,cb)}}else{if(cc){cc(0)}return 0}}function aY(cd,b7,ce,ch,cc,cg,cf,b8,cb){var ca=b.certificateFromCMP(cd,b7,ch,cc,cg,ce);if(!ca){a9(ae.XCRYPTO_SOFO_PKI_CERTIFICATEFROMCMP);cb(-1);return-1}var b9=function(ci){var cj=function(){if(cf==l){aA.clearMemCertKeyList();aA.saveMemCertKey(ca.signCert,ca.signKey,ca.kmCert,ca.kmKey);if(b8&2){if(cb){cb(by(ca.signCert,bM))}return 0}else{if(cb){cb(0)}return 0}}var co=function(cr){if(cr==1){if(o(av)==true){var cq=function(ct){if(ct==0){if(b8&2){if(cb){cb(by(ca.signCert,bM))}return 0}else{cb(0);return 0}}else{a9(ae.XCRYPTO_SOFO_STORAGE_SAVECERTKEY);cb(-1);return-1}if(cf==r){aA.saveCertKey(ca.signCert,ca.signKey,ca.kmCert,ca.kmKey,"session",1,cq)}else{if(aI==true){var cs=function(cu){if(cu==-5e3){aI=false;aA.saveCertKey(ca.signCert,ca.signKey,ca.kmCert,ca.kmKey,null,1,cq)}else{cq(cu)}};aA.saveOpenCertKey(ca.signCert,ca.signKey,ca.kmCert,ca.kmKey,cg,null,1,0,cs)}else{aA.saveCertKey(ca.signCert,ca.signKey,ca.kmCert,ca.kmKey,null,1,cq)}}}}else{cb(1);return 1}}else{if(cr!=0){a9(ae.XCRYPTO_SOFO_STORAGE_SAVECERTKEY);cb(cr);return cr}if(b8&2){if(cb){cb(by(ca.signCert,bM))}return cr}else{cb(cr);return cr}}};if(cf==r){aA.saveCertKey(ca.signCert,ca.signKey,ca.kmCert,ca.kmKey,"session",0,co)}else{if(aI==true){var cp=function(cq){if(cq==-5e3){aI=false;aA.saveCertKey(ca.signCert,ca.signKey,ca.kmCert,ca.kmKey,null,0,co)}else{co(cq)}};aA.saveOpenCertKey(ca.signCert,ca.signKey,ca.kmCert,ca.kmKey,cg,null,0,0,cp)}else{aA.saveCertKey(ca.signCert,ca.signKey,ca.kmCert,ca.kmKey,null,0,co)}}};var cn=false;if(ci.length>0){for(var ck=0;ck<ci.length;++ck){if(W(ci[ck].signCert.issuer).toLowerCase().indexOf(W(ca.signCert.issuer).toLowerCase())>=0){if(W(ci[ck].signCert.subject).toLowerCase().indexOf(W(ca.signCert.subject).toLowerCase())>=0){cn=true;var cm=function(co){if(co!=0){a9(ae.XCRYPTO_SOFO_STORAGE_DELETECERT);cb(-1);return-1}cj()};if(cf==r){aA.deleteCert(ck,"session",cm)}else{if(aI==true){var cl=function(co){if(co==-5e3){aI=false;aA.deleteCert(ck,null,cm)}else{cm(co)}};aA.deleteOpenCertFromIndex(ck,null,cl)}else{aA.deleteCert(ck,null,cm)}}}}}}if(cn===false){cj()}};if(cf==r){aA.getCertKeyList("session",b9)}else{aA.getCertKeyList(null,b9)}}function aC(ck,ci,ch,cj,b8,cd){if(ch==l){var ca=b.certificateFromPFX(ck,ci,cj);if(!ca){a9(ae.INTERFACE_IMPORTCERT+ae.XCRYPTO_SOFO_PKI_CERTIFICATEFROMPFX);if(cd){cd(-1)}return-1}aA.clearMemCertKeyList();aA.saveMemCertKey(ca.signCert,ca.signKey,ca.kmCert,ca.kmKey);if(cd){cd(0)}return 0}else{if(ch==V){var ca=b.certificateFromPFX(ck,ci,cj);if(!ca){a9(ae.INTERFACE_IMPORTCERT+ae.XCRYPTO_SOFO_PKI_CERTIFICATEFROMPFX);if(cd){cd(-1)}return-1}var ce=function(co){if(co==1){if(o(av)==true){var cn=function(cp){if(cp==0){if(cd){cd(0)}}else{a9(ae.INTERFACE_IMPORTCERT+ae.XCRYPTO_SOFO_STORAGE_SAVECERTKEY);if(cd){cd(-1)}}};if(aI==true){var cm=function(cp){if(cp==-5e3){aI=false;aA.saveCertKey(ca.signCert,ca.signKey,ca.kmCert,ca.kmKey,null,1,cn)}else{cn(cp)}};aA.saveOpenCertKey(ca.signCert,ca.signKey,ca.kmCert,ca.kmKey,ci,null,1,0,cm)}else{aA.saveCertKey(ca.signCert,ca.signKey,ca.kmCert,ca.kmKey,null,1,cn)}}else{if(cd){cd(1)}}}else{if(co!=0){a9(ae.INTERFACE_IMPORTCERT+ae.XCRYPTO_SOFO_STORAGE_SAVECERTKEY)}if(cd){cd(co)}return co}};if(aI==true){var cl=function(cm){if(cm==-5e3){aI=false;aA.saveCertKey(ca.signCert,ca.signKey,ca.kmCert,ca.kmKey,null,0,ce)}else{ce(cm)}};aA.saveOpenCertKey(ca.signCert,ca.signKey,ca.kmCert,ca.kmKey,ci,null,0,0,cl)}else{aA.saveCertKey(ca.signCert,ca.signKey,ca.kmCert,ca.kmKey,null,0,ce)}}else{if(ch==Y){if(b8&1){var ca=b.certificateFromPFX(ck,ci,cj);if(!ca){a9(ae.INTERFACE_IMPORTCERT+ae.XCRYPTO_SOFO_PKI_CERTIFICATEFROMPFX);if(cd){cd(-1)}return-1}var b7=function(cm){aA.deleteXfsCertKey(cm);aA.saveXfsCertKey(ca.signCert,ca.signKey,ca.kmCert,ca.kmKey);if(cd){cd(0)}return 0};b4(Y,W(ca.signCert.issuer),ca.signCert.serialNumber,"",1,b7)}else{var b9;try{if(typeof ck=="string"){if(ck.charAt(0)=="3"){var cc=forge.util.hexToBytes(ck);b9=forge.util.encode64(cc)}else{if(ck.charAt(0)=="M"){b9=ck}else{w(ae.INTERFACE_IMPORTCERT+ae.ERROR_INCORRECT_PARAM);if(cd){cd(-1)}return-1}}}else{var cc=forge.util.createBuffer(ck);b9=forge.util.encode64(cc.getBytes())}}catch(cb){w(ae.INTERFACE_IMPORTCERT+ae.ERROR_INCORRECT_PARAM,cb);if(cd){cd(-1)}return-1}if(cd){var cf=function(cm){if(cm!=0){a9(ae.INTERFACE_IMPORTCERT+ae.XCRYPTO_SOFO_XFS_CERTPFXIMPORT)}cd(cm)};X.certPfxImport(b9,cj,cf)}else{var cg=X.certPfxImport(b9,cj);if(cg!=0){a9(ae.INTERFACE_IMPORTCERT+ae.XCRYPTO_SOFO_XFS_CERTPFXIMPORT)}return cg}}}else{w(ae.INTERFACE_IMPORTCERT+ae.ERROR_INCORRECT_PARAM);if(cd){cd(-1)}return-1}}}}function a(cg,b7,cm,cc,cj,ci,ck,b8,ce){if(ci==l||ci==V){var ca=b.certificateFromDer(cg,b7,cm,cc,cj,ck);if(!ca){a9(ae.INTERFACE_IMPORTCERT+ae.XCRYPTO_SOFO_PKI_CERTIFICATEFROMDER);if(ce){ce(-1)}return-1}if(ci==l){aA.clearMemCertKeyList();aA.saveMemCertKey(ca.signCert,ca.signKey,ca.kmCert,ca.kmKey);if(ce){ce(0)}return 0}else{var cd=function(cp){if(cp==1){if(o(av)==true){var co=function(cq){if(cq==0){if(ce){ce(0)}return 0}else{a9(ae.INTERFACE_IMPORTCERT+ae.XCRYPTO_SOFO_STORAGE_SAVECERTKEY);if(ce){ce(-1)}return-1}};if(aI==true){var cn=function(cq){if(cq==-5e3){aI=false;aA.saveCertKey(ca.signCert,ca.signKey,ca.kmCert,ca.kmKey,null,1,co)}else{co(cq)}};aA.saveOpenCertKey(ca.signCert,ca.signKey,ca.kmCert,ca.kmKey,cj,null,1,0,cn)}else{aA.saveCertKey(ca.signCert,ca.signKey,ca.kmCert,ca.kmKey,null,1,co)}}else{if(ce){ce(1)}}}else{if(cp!=0){a9(ae.INTERFACE_IMPORTCERT+ae.XCRYPTO_SOFO_STORAGE_SAVECERTKEY);if(ce){ce(-1)}return-1}if(ce){ce(cp)}}};if(aI==true){var cl=function(cn){if(cn==-5e3){aI=false;aA.saveCertKey(ca.signCert,ca.signKey,ca.kmCert,ca.kmKey,null,0,cd)}else{cd(cn)}return};aA.saveOpenCertKey(ca.signCert,ca.signKey,ca.kmCert,ca.kmKey,cj,null,0,0,cl)}else{aA.saveCertKey(ca.signCert,ca.signKey,ca.kmCert,ca.kmKey,null,0,cd)}}}else{if(ci==Y){if(b8&1){var ca=b.certificateFromDer(cg,b7,cm,cc,cj,ck);if(!ca){a9(ae.INTERFACE_IMPORTCERT+ae.XCRYPTO_SOFO_PKI_CERTIFICATEFROMDER);if(ce){ce(-1)}return-1}var cb=b4(Y,W(ca.signCert.issuer),ca.signCert.serialNumber,"",1);aA.deleteXfsCertKey(cb);aA.saveXfsCertKey(ca.signCert,ca.signKey,ca.kmCert,ca.kmKey);if(ce){ce(0)}return 0}else{var ca=b.certificateFromDer(cg,b7,cm,cc,cj,cj);if(!ca){a9(ae.INTERFACE_IMPORTCERT+ae.XCRYPTO_SOFO_PKI_CERTIFICATEFROMDER);if(ce){ce(-1)}return-1}var b9=b.certificateToPKCS12(ca.signCert,ca.signKey,ca.kmCert,ca.kmKey,cj,cj,1);if(!b9){a9(ae.INTERFACE_IMPORTCERT+ae.XCRYPTO_SOFO_PKI_CERTIFICATETOPKCS12);if(ce){ce("")}return""}if(ce){var cf=function(cn){if(cn!=0){a9(ae.INTERFACE_IMPORTCERT+ae.XCRYPTO_SOFO_XFS_CERTPFXIMPORT)}ce(cn)};X.certPfxImport(b9,ck,cf)}else{var ch=X.certPfxImport(b9,ck);if(ch!=0){a9(ae.INTERFACE_IMPORTCERT+ae.XCRYPTO_SOFO_XFS_CERTPFXIMPORT)}return ch}}}else{w(ae.INTERFACE_IMPORTCERT+ae.ERROR_INCORRECT_PARAM);if(ce){ce(-1)}return-1}}}function ao(b7,ca,b9,ce,cd,b8,cc){var cb=function(ch){if(!ch){cc(-1)}var ci=b.certificateToPKCS12(ch.signCert,ch.signKey,ch.kmCert,ch.kmKey,ce,cd,0);if(!ci){cc(-1)}var cf;if(b8){cf=b8}else{cf=forge.util.decodeUtf8(ch.signCert.subject.getField("CN").value);if(cf){cf+=".pfx"}else{cf="cert.pfx"}}var cg=document.createElement("a");if("download"in cg){cg.setAttribute("href","data:application/x-pkcs12;base64,"+ci);cg.setAttribute("download",cf);cg.style.display="none";document.body.appendChild(cg);cg.click();document.body.removeChild(cg)}else{cc(-1)}cc(0)};b4(b7,ca,b9,ce,2,cb)}function b5(ch,ca,cb,cd,ce,b9,cf){var b7=function(ci){if(!ci){w(ae.INTERFACE_EXPORTCERT+ae.ERROR_GETCERTIFICATE);if(cf){cf("")}return""}var cj=b.certificateToPKCS12(ci.signCert,ci.signKey,ci.kmCert,ci.kmKey,cd,ce,b9);if(!cj){a9(ae.INTERFACE_EXPORTCERT+ae.XCRYPTO_SOFO_PKI_CERTIFICATETOPKCS12);if(cf){cf("")}return""}if(cf){cf(cj)}return cj};if(ch==l||ch==V){var b8=b4(ch,ca,cb,cd,2,b7)}else{if(ch==Y){var cg=function(ci){var cj;if(ci.charAt(0)=="3"){if(b9&1){var ck=forge.util.hexToBytes(ci);cj=forge.util.encode64(ck)}else{cj=ci}}else{if(ci.charAt(0)=="M"){if(b9&1){cj=ci}else{var ck=forge.util.decode64(ci);cj=forge.util.bytesToHex(ck)}}else{cj="";a9(ae.INTERFACE_EXPORTCERT+ae.XCRYPTO_SOFO_XFS_CERTPFXEXPORT)}}if(cf){cf(cj)}else{return cj}};if(cf){X.certPfxExport(ca,cb,cd,cg)}else{var cc=X.certPfxExport(ca,cb,cd);return cg(cc)}}else{w(ae.INTERFACE_EXPORTCERT+ae.ERROR_INCORRECT_PARAM);if(cf){cf("")}return""}}}function aM(b7){if(!b7){return-1}switch(b7.toLowerCase()){case"md5":return 0;case"sha1":return 1;case"sha256":return 2;case"sha384":return 3;case"sha512":return 4;default:return-1}}function aq(cp,cq,ci,cs,b8,ce,ch,ct,cm){var cd;if(ch==0){cd=ae.INTERFACE_SIGNDATA}else{if(ch==1){cd=ae.INTERFACE_SIGNDATAADD}else{if(ch==2){cd=ae.INTERFACE_SIGNDATA_UCPID}else{bB.log("_signData error");return}}}if(cp==Y&&an.signType!=k){var cj=null;if(!cq||!ci||!cs){w(cd+ae.ERROR_INCORRECT_PARAM);if(ct){ct("")}return""}var co=function(cv){if(!cv){if(an.signType==v){a9(cd+ae.XCRYPTO_SOFO_XFS_CERTDIGESTSIGN)}else{a9(cd+ae.XCRYPTO_SOFO_XFS_CERTSIGN)}if(ct){ct("")}return""}var cu=b.convertSignedData(cv,cj,ce,at);if(!cu){a9(cd+ae.XCRYPTO_SOFO_PKI_CONVERTSIGNEDDATA);if(ct){ct("")}return""}if(ct){ct(cu)}return cu};if(an.signType==k){}else{if(an.signType==v){var cl=function(cw){if(!cw||cw.length==0){a9(cd+ae.XCRYPTO_SOFO_XFS_CERTDETAIL);if(ct){ct("")}return""}cw=cw[0];if(!cw.signatureAlgId){w(cd+ae.ERROR_GETCERTIFICATE);if(ct){ct("")}return""}var cv;if(cw.signatureAlgId.indexOf(" ")>0){cv=cw.signatureAlgId.split(" ")[0]}else{if(cw.signatureAlgId.indexOf("+")>0){cv=cw.signatureAlgId.split("+")[0]}else{cv=cw.signatureAlgId}}var cu=aM(cv);if(cu==-1){w(cd+ae.ERROR_GETCERTIFICATE);if(ct){ct("")}return""}cj=b8;var cy=b.hashData(cu,b8,0,at);if(ct){X.certDigestSign(cq,ci,cs,cy,ce,co)}else{var cx=X.certDigestSign(cq,ci,cs,cy,ce);return co(cx)}};if(ct){X.certDetail(cq,ci,cl)}else{var cr=X.certDetail(cq,ci);return cl(cr)}}else{if(ct){X.certSign(cq,ci,cs,b8,ce,at,co)}else{var cg=X.certSign(cq,ci,cs,b8,ce,at);return co(cg)}}}}else{var cb=be(cp);var b7;var cf;var ca;var cc;var ck;var b9;var cn=function(cv){if(cp==V&&cq&&ci&&cs||cp==r&&cq&&ci&&cs||cp==l&&cs||cp==Y&&an.signType==k&&cq&&ci&&cs){b7=cv}else{if(!cb){w(cd+ae.ERROR_INCORRECT_PARAM);if(ct){ct("")}return""}cf=cv;if(!cf){w(cd+ae.ERROR_GETCERTIFICATE);if(ct){ct("")}return""}cs=cf.keyword;b7=cf.cert}if(!b7){w(cd+ae.ERROR_GETCERTIFICATE);if(ct){ct("")}return""}if(typeof b8=="object"){ca=b7.signCert.md.algorithm.trim().toLowerCase();cc=b8.hash.split("$");for(var cw=0;cw<cc.length;cw++){ck=cc[cw].split("|");if(ck.length<2){break}if(ck[0].trim().toLowerCase()==ca){b9=ck[1];break}}b8=b8.info+"|"+b9}var cx;if(ch==0){cx=b.signDataCMS(b7.signCert,b7.signKey,cs,b8,ce,at)}else{if(ch==1){cx=b.signDataAddition(b7.signCert,b7.signKey,cs,b8,ce,at)}else{if(ch==2){cx=b.signDataUCPID(b7.signCert,b7.signKey,cs,cq,b8,cm,ce,at)}}}if(cx){if(cb&&!cf){var cu=function(cy){if(cy!=0){a9(cd+ae.XCRYPTO_SOFO_STORAGE_SETCACHEDCERT);if(ct){ct("")}return""}else{if(ct){ct(cx)}return cx}};e(cp,cq,ci,b7,cs,cu)}else{if(ct){ct(cx)}return cx}}else{if(ch==0){a9(cd+ae.XCRYPTO_SOFO_PKI_SIGNDATA)}else{a9(cd+ae.XCRYPTO_SOFO_PKI_SIGNDATAADDITION)}if(ct){ct("")}return""}};if(cp==V&&cq&&ci&&cs||cp==r&&cq&&ci&&cs||cp==l&&cs||cp==Y&&an.signType==k&&cq&&ci&&cs){return b4(cp,cq,ci,cs,2,cn)}else{return af(cp,cn)}}}function bu(ca,b9,b8){var b7=b.verifySignedData(ca,b9,b8,at);if(b7){if(typeof b7.plain=="string"){if(M()!=0){a9(ae.INTERFACE_VERIFYDATA+ae.XCRYPTO_SOFO_PKI_VERIFYSIGNEDDATA)}return b7.plain}else{a9(ae.INTERFACE_VERIFYDATA+ae.XCRYPTO_SOFO_PKI_VERIFYSIGNEDDATA);return""}}else{a9(ae.INTERFACE_VERIFYDATA+ae.XCRYPTO_SOFO_PKI_VERIFYSIGNEDDATA);return""}}function bq(ca,b9,b8){var b7=b.convertSignedData(ca,b9,b8,at);if(b7){return b7}else{a9(ae.INTERFACE_GETSIGNEDDATA+ae.XCRYPTO_SOFO_PKI_CONVERTSIGNEDDATA);return""}}function a6(cg,ca,cd,ch,cc,ce,cf){var b8=be(cg);var b9;var cb;var b7=function(cj){if(cg==V&&ca&&cd&&ch||cg==l&&ch||cg==Y&&an.signType==k&&ca&&cd&&ch){b9=cj}else{if(!b8){w(ae.INTERFACE_ENVELOPIDNUM+ae.ERROR_INCORRECT_PARAM);if(cf){cf("")}return""}cb=cj;if(!cb){w(ae.INTERFACE_ENVELOPIDNUM+ae.ERROR_GETCERTIFICATE);if(cf){cf("")}return""}ch=cb.keyword;b9=cb.cert}if(!b9){w(ae.INTERFACE_ENVELOPIDNUM+ae.ERROR_GETCERTIFICATE);if(cf){cf("")}return""}var ci=b.envelopeIdNum(b9.signCert,b9.signKey,ch,cc,ce);if(ci){if(cf){cf(ci)}return ci}else{a9(ae.INTERFACE_ENVELOPIDNUM+ae.XCRYPTO_SOFO_PKI_ENVELOPEIDNUM);if(cf){cf("")}return""}};if(cg==V&&ca&&cd&&ch||cg==l&&ch||cg==Y&&an.signType==k&&ca&&cd&&ch){return b4(cg,ca,cd,ch,2,b7)}else{return af(cg,b7)}}function j(cg,ch,ce,ck,ca,cf){var cd=[];var cj=[];var cc=0;var b9=cg.split("\t\n");var ci=ch.split("\t\n");var b8=ce.split("\t\n");if(b9.length!=ci.length||b9.length!=b8.length){w(ae.INTERFACE_ENVELOPEDATAWITHCERT+ae.ERROR_INCORRECT_PARAM);cf("")}for(var cb=0;cb<b9.length;cb++){if(b9[cb]==""){continue}if(b9[cb]==V&&(!ci[cb]||!b8[cb])){w(ae.INTERFACE_ENVELOPEDATAWITHCERT+ae.ERROR_INCORRECT_PARAM);cf("")}if(b9[cb]==Y&&(!ci[cb]||!b8[cb])){w(ae.INTERFACE_ENVELOPEDATAWITHCERT+ae.ERROR_INCORRECT_PARAM);cf("")}if(b9[cb]!=l&&b9[cb]!=V&&b9[cb]!=Y){w(ae.INTERFACE_ENVELOPEDATAWITHCERT+ae.ERROR_NOT_SUPPORTED_MEDIA);cf("")}cd.push({mediaIDList:b9[cb],issuerRDNList:ci[cb],certSerialList:b8[cb]})}var b7=function(cm){if(!cm){w(ae.INTERFACE_ENVELOPEDATAWITHCERT+ae.ERROR_GETCERTIFICATE);cf("")}cj.push(cm.kmCert?cm.kmCert:cm.signCert);cd.splice(cc,1);if(cd.length!=0){b4(cd[cc].mediaIDList,cd[cc].issuerRDNList,cd[cc].certSerialList,"",2,b7)}if(!cj||cj.length<=0){w(ae.INTERFACE_ENVELOPEDATAWITHCERT+ae.ERROR_GETCERTIFICATE);cf("")}var cl=b.envelopeData(cj,null,ck,ca,at);if(cl){cf(cl)}else{a9(ae.INTERFACE_ENVELOPEDATAWITHCERT+ae.XCRYPTO_SOFO_PKI_ENVELOPEDATA);cf("")}};b4(cd[cc].mediaIDList,cd[cc].issuerRDNList,cd[cc].certSerialList,"",2,b7)}function bS(b9,cc,ca){var b8=[];try{var ce=b9.split(";");for(var cb=0;cb<ce.length;cb++){b8.push(forge.pki.certificateFromPem(ce[cb]))}}catch(cd){w(ae.INTERFACE_ENVELOPEDATAWITHPEM+ae.ERROR_INCORRECT_PARAM,cd);return""}var b7=b.envelopeData(b8,null,cc,ca,at);if(b7){return b7}else{a9(ae.INTERFACE_ENVELOPEDATAWITHPEM+ae.XCRYPTO_SOFO_PKI_ENVELOPEDATA);return""}}function bI(b8,ca,b9){var b7=b.envelopeData(null,b8,ca,b9,at);if(b7){return b7}else{a9(ae.INTERFACE_ENVELOPEDATAWITHPWD+ae.XCRYPTO_SOFO_PKI_ENVELOPEDATA);return""}}function bd(cf,cb,cd,cg,b8,ce){var b9=be(cf);var ca;var cc;var b7=function(ci){if(cf==V&&cb&&cd&&cg||cf==l&&cg||cf==Y&&an.signType==k&&cb&&cd&&cg){ca=ci}else{if(!b9){w(ae.INTERFACE_DEENVELOPEDATAWITHCERT+ae.ERROR_INCORRECT_PARAM);if(ce){ce("")}return""}cc=ci;if(!cc){w(ae.INTERFACE_DEENVELOPEDATAWITHCERT+ae.ERROR_GETCERTIFICATE);if(ce){ce("")}return""}cg=cc.keyword;ca=cc.cert}if(!ca){w(ae.INTERFACE_DEENVELOPEDATAWITHCERT+ae.ERROR_GETCERTIFICATE);if(ce){ce("")}return""}var ch;if(ca.kmCert&&ca.kmKey){ch=b.deenvelopeData(ca.kmCert,ca.kmKey,cg,null,b8,0,at)}else{ch=b.deenvelopeData(ca.signCert,ca.signKey,cg,null,b8,0,at)}if(typeof ch=="string"){if(ce){ce(ch)}return ch}else{a9(ae.INTERFACE_DEENVELOPEDATAWITHCERT+ae.XCRYPTO_SOFO_PKI_DEENVELOPEDATA);if(ce){ce("")}return""}};if(cf==V&&cb&&cd&&cg||cf==l&&cg||cf==Y&&an.signType==k&&cb&&cd&&cg){return b4(cf,cb,cd,cg,2,b7)}else{return af(cf,b7)}}function N(b8,b9){var b7=b.deenvelopeData(null,null,null,b8,b9,0,at);if(typeof b7=="string"){return b7}else{a9(ae.INTERFACE_DEENVELOPEDATAWITHPWD+ae.XCRYPTO_SOFO_PKI_DEENVELOPEDATA);return""}}function bA(ci,ca,cn,cm,ck,cl,cd,ch,b8,cj){try{cd=parseInt(cd);if(typeof cd=="number"){if(cd<0||cd>8){w(ae.INTERFACE_REQUESTCERT+ae.ERROR_INCORRECT_PARAM);if(cj){cj(-1);return}else{return-1}}}else{cd=4}var cg=bU.getWebCMPType(ci);var b7=bU.getWebCMPpKeyID(ci);var cc=bU.getWebCMPOnlySignCert(ci);var cf=bU.getCmpClient(cg,b7,ca,cd,ch,cc);cf.issue(cn,cm,function(co){if(co===ae){w(ae.INTERFACE_REQUESTCERT+ae.ERROR_REQUESTCERT);cj(-1);return}aY(co[0].certificate,co[0].privateKey,co[0].vid,co[1]?co[1].certificate:null,co[1]?co[1].privateKey:null,cl,ck,b8,cj)})}catch(cb){var b9="";for(var ce in cb){b9+=ce+" : "+cb[ce]+"\n"}bB.log(b9);w(ae.INTERFACE_REQUESTCERT+ae.ERROR_REQUESTCERT);cj(-1)}}function aK(cc,cf,ci,cl,cd,cn,b9,ca,b8,cb,cm){try{ca=parseInt(ca);if(typeof ca=="number"){if(ca<0||ca>8){w(ae.INTERFACE_REQUESTCERT+ae.ERROR_INCORRECT_PARAM);if(cm){cm(-1);return}else{return-1}}}else{ca=4}var co=bU.getWebCMPType(cc);var cp=bU.getWebCMPpKeyID(cc);var cj=bU.getWebCMPOnlySignCert(cc);var cg=bU.getCmpClient(co,cp,cf,ca,b8,cj);var ch=function(cq){if(!cq){cm(-1);w(ae.INTERFACE_RENEWCERT+ae.ERROR_GETCERTIFICATE);return}if(aI==true){cd=cq.signCert.serialNumber}cg.update(cq.signCert,cq.signKey,cq.kmCert,cq.kmKey,cd,cn,0,function(cs){if(cs===ae){w(ae.INTERFACE_RENEWCERT+ae.ERROR_RENEWCERT);cm(-1);return}var cr=function(ct){if(cb&2){if(ct==-1||ct==1){a9(ae.INTERFACE_RENEWCERT)}else{cm(ct)}}else{if(ct!=0){a9(ae.INTERFACE_RENEWCERT)}else{cm(0)}}};aY(cs[0].certificate,cs[0].privateKey,cs[0].vid,cs[1]?cs[1].certificate:null,cs[1]?cs[1].privateKey:null,b9,ci,cb,cr)})};b4(ci,cl,cd,cn,0,ch)}catch(ce){var b7="";for(var ck in ce){b7+=ck+" : "+ce[ck]+"\n"}bB.log(b7);w(ae.INTERFACE_RENEWCERT+ae.ERROR_RENEWCERT);cm(-1)}}function bW(b7,ca,b8,b9,cc){var cb=function(cd){if(!cd){w(ae.INTERFACE_GETCERT+ae.ERROR_GETCERTIFICATE);return""}if(b9&16){cd=cd.kmCert}else{cd=cd.signCert}if(!cd){w(ae.INTERFACE_GETCERT+ae.ERROR_GETCERTIFICATE);return""}try{var cf;if(b9&2){cf=forge.pki.certificateToPem(cd)}else{if(b9&1){cf=forge.util.encode64(forge.asn1.toDer(forge.pki.certificateToAsn1(cd)).getBytes())}else{cf=forge.util.bytesToHex(forge.asn1.toDer(forge.pki.certificateToAsn1(cd)).getBytes())}}if(cf){cc(cf)}else{w(ae.INTERFACE_GETCERT+ae.ERROR_GETCERTIFICATE);cc("")}}catch(ce){w(ae.INTERFACE_GETCERT+ae.ERROR_GETCERTIFICATE,ce);cc("")}};b4(b7,ca,b8,"",2,cb)}function f(ca,b8,b7){var b9=b.hashData(ca,b8,b7,at);if(b9){return b9}else{a9(ae.INTERFACE_HASHDATA+ae.XCRYPTO_SOFO_PKI_HASHDATA);return""}}function D(ca,b8,b9,b7){return aA.syncOpenCert(ca,b8,b9,b7)}function bb(b7){return aA.setOpenColudTray(b7)}function az(b9,cb,ce,cc,b7,b8,ca,cd){var cf=function(ch){if(ch!=0){cd(ch);return}var cg=function(cj){if(cj!=0){cd(cj);return}var ci=function(cl){if(!cl){a9(ae.INTERFACE_ANYCERTRELAY_EXPORT+ae.ERROR_GETCERTIFICATE);if(cd){cd(-1)}return-1}if(cl.signCert.subject.getField("OU").value.toUpperCase().indexOf("PERSONALB")>=0||cl.signCert.subject.getField("OU").value.toUpperCase().indexOf("CORPORATION4ECB")>=0){w(ae.ERROR_NOT_SUPPORTED_BROWSERCERT);if(cd){cd(-1)}return-1}var cn=null;var cm=null;if(b7!=b8){cn=b.changeEncryptPrivateKey(cl.signKey,b7,b8);if(!cn){a9(ae.INTERFACE_ANYCERTRELAY_EXPORT+ae.XCRYPTO_SOFO_PKI_CHANGEENCRYPTPRIVATEKEY);if(cd){cd(-1)}return-1}if(cl.kmCert&&cl.kmKey){cm=b.changeEncryptPrivateKey(cl.kmKey,b7,b8);if(!cm){a9(ae.INTERFACE_ANYCERTRELAY_EXPORT+ae.XCRYPTO_SOFO_PKI_CHANGEENCRYPTPRIVATEKEY);if(cd){cd(-1)}return-1}}}else{cn=cl.signKey;if(cl.kmCert&&cl.kmKey){cm=cl.kmKey}}var ck=function(cp){if(!cp){if(cd){cd(-1)}return-1}var cr=b.certificateToPKCS12ForCertRelay(cl.signCert,cn,cl.kmCert,cm,cp,0);if(!cr){a9(ae.INTERFACE_ANYCERTRELAY_EXPORT+ae.XCRYPTO_SOFO_PKI_CERTIFICATETOPKCS12);if(cd){cd(-1)}return-1}var cq=W(cl.signCert.subject)+new Date;var co=b.signDataCMS(cl.signCert,cn,b8,cq,0,at);if(!co){a9(ae.INTERFACE_ANYCERTRELAY_EXPORT+ae.XCRYPTO_SOFO_PKI_SIGNDATA);if(cd){cd(-1)}return-1}var cs=function(ct){if(ct!=0){cd(ct);return}if(cd){cd(ct)}return 0};a4.exportCertRelay(b9,cb,cr,co,ca,cs)};return a4.generatePKCS12Password(cb,ck)};return b4(V,ce,cc,b7,2,ci)};return a4.registerAuthCode(b9,cb,ca,cg)};return a4.getServerCert(b9,ca,cf)}function R(b8,cb,ca,b7){var b9=function(cd){if(cd!=0){b7(cd);return}var cc=function(cf){if(!cf){if(b7){b7(-1)}return-1}var ce=function(cg){if(cg==-1){b7(-1);return-1}var ci=b.certificateFromPFXForCertRelay(cg,cf);if(!ci){w(ae.INTERFACE_ANYCERTRELAY_IMPORT+ae.ERROR_ACR_CERTIFICATEFROMPFX);if(b7){b7(-1)}return-1}var ch=function(ck){if(ck==1){if(o(av)==true){var cj=function(cl){if(cl==0){if(b7){b7(0)}return 0}else{if(b7){b7(-1)}return-1}};return aA.saveCertKey(ci.signCert,ci.signKey,ci.kmCert,ci.kmKey,null,1,cj)}else{if(b7){b7(1)}return-1}}else{if(b7){b7(ck)}return ck}};return aA.saveCertKey(ci.signCert,ci.signKey,ci.kmCert,ci.kmKey,null,0,ch)};return a4.importCertRelay(b8,cb,ca,ce)};return a4.generatePKCS12Password(cb,cc)};return a4.getServerCert(b8,ca,b9)}function ah(b8,cb,ca,b7){var b9=function(cd){if(cd!=0){b7(cd);return}var cc=function(ce){if(ce!=0){b7(ce);return}else{b7(ce);return}};return a4.registerAuthCode(b8,cb,ca,cc)};return a4.getServerCert(b8,ca,b9)}function aT(ce,cd,b9,b8,cc,b7,cb,ca){X.init(ce,cd,b9,ca);an.signType=b8;bR.type=cc;bR.certList=b7;bR.storageElementID=cb}function al(b8,cc,cb,ca,b7){if(b7){var b9=function(ce){if(ce!=0){a9(ae.INTERFACE_XFSLOGIN+ae.XCRYPTO_SOFO_XFS_USERLOGIN)}b7(ce)};X.userLogin(b8,cc,cb,ca,b9)}else{var cd=X.userLogin(b8,cc,cb,ca);if(cd!=0){a9(ae.INTERFACE_XFSLOGIN+ae.XCRYPTO_SOFO_XFS_USERLOGIN)}return cd}}function bj(b8,b7){if(b7){var b9=function(cb){if(cb!=0){a9(ae.INTERFACE_XFSOTPREQUEST+ae.XCRYPTO_SOFO_XFS_OTPREQUEST)}b7(cb)};X.otpRequest(b8,b9)}else{var ca=X.otpRequest(b8);if(ca!=0){a9(ae.INTERFACE_XFSOTPREQUEST+ae.XCRYPTO_SOFO_XFS_OTPREQUEST)}return ca}}function bk(b7){if(b7){var b8=function(ca){if(ca!=0){a9(ae.INTERFACE_XFSLOGOUT+ae.XCRYPTO_SOFO_XFS_USERLOGOUT)}b7(ca)};X.userLogout(b8)}else{var b9=X.userLogout();if(b9!=0){a9(ae.INTERFACE_XFSLOGOUT+ae.XCRYPTO_SOFO_XFS_USERLOGOUT)}return b9}}function bC(cc,cb,b9,ca,b8,b7,cd){ca=parseInt(ca);if(typeof ca=="number"){if(ca<0||ca>8){ca=4}}else{ca=4}if(!aG){au()}E.init(cc,cb,b9,ca,b8,aH,b7,cd)}function bt(b9,cb,ca,b7){var b8=function(cc){if(!cc){a9(ae.INTERFACE_ANYPIN_GETPINIDLIST+ae.XCRYPTO_SOFO_ANYPIN_GETPINIDLIST)}if(b7){b7(cc)}return cc};return E.getPinIDList(b9,cb,ca,at,b8)}function bE(b9,b7){var b8=function(ca){if(ca!=0){a9(ae.INTERFACE_ANYPIN_UPDATEPINLASTTIME+ae.XCRYPTO_SOFO_ANYPIN_UPDATEPINLASTTIME)}if(b7){b7(ca)}return ca};return E.updatePinLastTime(b9,b8)}function bv(ca,b9,b7,cc,b8){var cb=E.checkPin(ca,b9,b7,cc,b8);if(cb!=0){a9(ae.INTERFACE_ANYPIN_CHECKPIN+ae.XCRYPTO_SOFO_ANYPIN_CHECKPIN)}return cb}function aJ(ca,b9,b7){var b8=function(cb){if(!cb){a9(ae.INTERFACE_ANYPIN_INITPIN+ae.XCRYPTO_SOFO_ANYPIN_INITPIN)}if(b7){b7(cb)}return cb};return E.initPin(ca,b9,b8)}function bf(ca,b9,b7){var b8=function(cb){if(!cb){a9(ae.INTERFACE_ANYPIN_INITREGIST+ae.XCRYPTO_SOFO_ANYPIN_INITREGIST)}if(b7){b7(cb)}return cb};return E.initRegist(ca,b9,b8)}function bX(b9,b7,cf,cc,cg,ce,b8,ca,cb){var cd=function(ch){if(ch<0){a9(ae.INTERFACE_ANYPIN_REGISTPIN+ae.XCRYPTO_SOFO_ANYPIN_REGISTPIN)}if(cb){cb(ch)}return ch};return E.registPin(b9,b7,cf,at,cc,cg,ce,b8,ca,cd)}function bZ(ca,b9,b7){var b8=function(cb){if(!cb){a9(ae.INTERFACE_ANYPIN_INITSESSION+ae.XCRYPTO_SOFO_ANYPIN_INITSESSION)}if(b7){b7(cb)}return cb};return E.initSession(ca,b9,b8)}function S(ca,b9,b7){var b8=function(cb){if(cb!=0){a9(ae.INTERFACE_ANYPIN_SETNODUEDAY+ae.XCRYPTO_SOFO_ANYPIN_SETNODUEDAY)}if(b7){b7(cb)}return cb};return E.setNoDueDay(ca,b9,b8)}function d(b8,cb,ca,cf,ce,b7,b9,cc){var cd=function(cg){if(cg!="success"&&cg!="update"){a9(ae.INTERFACE_ANYPIN_AUTHSESSION+ae.XCRYPTO_SOFO_ANYPIN_AUTHSESSION)}if(cc){cc(cg)}return cg};return E.authSession(b8,cb,ca,cf,ce,b7,at,b9,cd)}function ad(b9,b7){var b8=function(ca){if(ca!=0){a9(ae.INTERFACE_ANYPIN_ENDSESSION+ae.XCRYPTO_SOFO_ANYPIN_ENDSESSION)}if(b7){b7(ca)}return ca};return E.endSession(b9,b8)}function P(cc,cb,ca,b9,b7){var b8=function(cd){if(!cd){a9(ae.INTERFACE_ANYPIN_SIGNPIN+ae.XCRYPTO_SOFO_ANYPIN_SIGNPIN)}if(b7){b7(cd)}return cd};return E.signPin(cc,cb,ca,at,b9,b8)}function bo(ca,b9,b7){var b8=function(cb){if(cb!=0){a9(ae.INTERFACE_ANYPIN_DELETEPIN+ae.XCRYPTO_SOFO_ANYPIN_DELETEPIN)}if(b7){b7(cb)}return cb};return E.deletePin(ca,b9,b8)}function O(ca,b9,b7){var b8=function(cb){if(cb!=0){a9(ae.INTERFACE_ANYPIN_DELETEALLPIN+ae.XCRYPTO_SOFO_ANYPIN_DELETEALLPIN)}if(b7){b7(cb)}return cb};return E.deleteAllPin(ca,b9,b8)}function bl(ca,b9,b7){var b8=function(cb){if(cb!=0){a9(ae.INTERFACE_ANYPIN_DELETEPIN+ae.XCRYPTO_SOFO_ANYPIN_DELETEPIN)}if(b7){b7(cb)}return cb};return E.deletePinLocal(ca,b9,b8)}function aO(cc,ca,cb,b9,b7){var b8=function(cd){if(cd!=0){a9(ae.INTERFACE_ANYPIN_CHANGEPIN+ae.XCRYPTO_SOFO_ANYPIN_CHANGEPIN)}if(b7){b7(cd)}return cd};return E.changePin(cc,ca,cb,b9,b8)}function z(cc,cb,ca,b9,b7){var b8=function(cd){if(cd!=0){
a9(ae.INTERFACE_ANYPIN_READDEVICEINFOLIST+ae.XCRYPTO_SOFO_ANYPIN_READDEVICEINFOLIST)}if(b7){b7(cd)}return cd};return E.readDeviceInfoList(cc,cb,ca,b9,b8)}function bD(cb,ca,b9,b7){var b8=function(cc){if(cc!=0){a9(ae.INTERFACE_ANYPIN_READDEVICEINFO+ae.XCRYPTO_SOFO_ANYPIN_READDEVICEINFO)}if(b7){b7(cc)}return cc};return E.readDeviceInfo(cb,ca,b9,b8)}function bV(cb,ca,b9,b7){var b8=function(cc){if(cc!=0){a9(ae.INTERFACE_ANYPIN_DELETEDEVICE+ae.XCRYPTO_SOFO_ANYPIN_DELETEDEVICE)}if(b7){b7(cc)}return cc};return E.deleteDevice(cb,ca,b9,b8)}function ab(ca,b9,b7){var b8=function(cb){if(cb!=0){a9(ae.INTERFACE_ANYPIN_DELETEALLDEVICE+ae.XCRYPTO_SOFO_ANYPIN_DELETEALLDEVICE)}if(b7){b7(cb)}return cb};return E.deleteAllDevice(ca,b9,b8)}function aQ(b9,ch,cc,cd,ca,ce,b7,cb,b8,cf){var cg=function(ci){if(ci!=0){a9(ae.INTERFACE_ANYPIN_READAUDITINFOLIST+ae.XCRYPTO_SOFO_ANYPIN_READAUDITINFOLIST)}if(cf){cf(ci)}return ci};return E.readAuditInfoList(b9,ch,cc,cd,ca,ce,b7,cb,b8,cg)}function g(cb,b7,ca,b8){var b9=function(cc){if(cc!=0){a9(ae.INTERFACE_ANYPIN_READAUDITINFO+ae.XCRYPTO_SOFO_ANYPIN_READAUDITINFO)}if(b8){b8(cc)}return cc};return E.readAuditInfo(cb,b7,ca,b9)}function bY(b7,b8){return E.testCERTMODEGenPubKey(b7,b8)}function aX(b9,b7,ca,b8,cb){return E.testSaveCertAndKey(b9,b7,ca,b8,cb)}return{checkXCrypto:function(){return ak()},isMobilePlatform:function(){return b0()},getDeviceInfo:function(b7){bs();if(typeof b7!="function"){b7=null}if(!a5()){w(ae.INTERFACE_GETDEVICEINFO+ae.ERROR_SETLICENSE_FAIL);if(b7){b7("");return}else{return""}}var b8=am();if(b7){b7(b8)}else{return b8}},getLastErrCode:function(){return M()},getLastErrMsg:function(){return bT()},getLastErrInternal:function(){return aw()},resetErrAndMsg:function(){bs()},setError:function(b8,b7){if(typeof b7!="function"){b7=null}b8=parseInt(b8);w(b8);if(b7){b7()}},resetError:function(b7){if(typeof b7!="function"){b7=null}bs();if(b7){b7()}},getError:function(b7){if(typeof b7!="function"){b7=null}var b8=aU();if(b7){b7(b8)}else{return b8}},setLanguage:function(b8,b7){if(typeof b7!="function"){b7=null}bG(b8);if(b7){b7()}},setCharset:function(b8,b7){if(typeof b7!="function"){b7=null}C(b8);if(b7){b7()}},setLicense:function(b9,b7){bs();if(typeof b7!="function"){b7=null}if(!b9){w(ae.INTERFACE_SETLICENSE+ae.ERROR_INCORRECT_PARAM);if(b7){b7(-1)}return-1}var b8=ac(b9);if(b7){b7(b8)}else{return b8}},setProperty:function(ca,b8,b9,b7){if(typeof b7!="function"){b7=null}bG(ca);C(b8);ac(b9);if(b7){b7()}},setSecurityContext:function(b9,b8,b7){bs();if(typeof b7!="function"){b7=null}if(!b9){w(ae.INTERFACE_SETSECURITYCONTEXT+ae.ERROR_INCORRECT_PARAM);if(b7){b7(-1)}return-1}var ca=U(b9,b8);if(b7){b7(ca)}else{return ca}},setCrossStorage:function(b8,ca,b7){bs();if(typeof b7!="function"){b7=null}var b9=function(cb){if(cb!=0){a9(ae.INTERFACE_SETCROSSSTORAGE)}if(b7){b7(cb)}else{return cb}};b1(b8,ca,b9)},setOpenStorage:function(b8,cd,cb,b7,b9){bs();if(typeof b9!="function"){b9=null}var cc=function(ce){if(ce!==0){a9(ae.INTERFACE_SETOPENSTORAGE)}if(b9){b9(ce)}else{return ce}};var ca=m(b8);bP(ca,cd,cb,b7,cc)},setIssuerConvertTable:function(b8,ca,b9,cc,b7){bs();if(typeof b7!="function"){b7=null}if(!b8||!ca){w(ae.INTERFACE_SETISSUERCONVERTTABLE+ae.ERROR_INCORRECT_PARAM);if(b7){b7(-1)}return-1}if(!b9){b9=""}cc=parseInt(cc);var cb=aV(b8,ca,b9,cc);if(b7){b7(cb)}else{return cb}},setPolicyConvertTable:function(ca,b9,b8,cc,b7){bs();if(typeof b7!="function"){b7=null}if(!ca||!b9){w(ae.INTERFACE_SETPOLICYCONVERTTABLE+ae.ERROR_INCORRECT_PARAM);if(b7){b7(-1)}return-1}if(!b8){b8=""}cc=parseInt(cc);var cb=aE(ca,b9,b8,cc);if(b7){b7(cb)}else{return cb}},setSecureInput:function(b8,b7){bs();if(typeof b7!="function"){b7=null}b2(b8);if(b7){b7()}},getSecureInput:function(b7){bs();if(typeof b7!="function"){b7=null}var b8=bJ();if(b7){b7(b8)}else{return b8}},setLastLocation:function(b7,b8){bs();if(typeof b8!="function"){b8=null}var b9=function(ca){if(ca!=0){a9(ae.INTERFACE_SETLASTLOCATION)}if(b8){b8(ca)}};bQ(b7,b9)},getLastLocation:function(b7){bs();if(typeof b7!="function"){b7=null;return-1}bK(b7)},generateRandom:function(b9,b8,b7){bs();if(typeof b7!="function"){b7=null}var ca=ax(b9,b8);if(b7){b7(ca)}else{return ca}},setCacheCertLocation:function(b7,b8){bs();if(typeof b8!="function"){b8=null}var b9=function(ca){if(ca!=0){a9(ae.INTERFACE_SETCACHECERTLOCATION)}if(b8){b8(ca)}};aZ(b7,b9)},getCacheCertLocation:function(b8,b7){bs();if(typeof b7!="function"){b7=null;return-1}T(b8,b7)},hasCachedData:function(b7){bs();if(typeof b7!="function"){b7=null}var b8=function(b9){if(b9==0){b7(1)}else{b7(0)}};F(b8)},clearCachedData:function(b7){bs();if(typeof b7!="function"){b7=null}bg(b7)},getMediaList:function(b9,b8,b7){bs();if(!a5()){w(ae.INTERFACE_GETMEDIALIST+ae.ERROR_SETLICENSE_FAIL);if(b7){b7(-1);return}else{return-1}}b9=parseInt(b9);if(typeof b7!="function"){b7=null}return ap(b9,b8,b7)},getCertTree:function(b8,b7,ca,cb,cc,cd,b9){bs();if(!a5()){w(ae.INTERFACE_GETCERTTREE+ae.ERROR_SETLICENSE_FAIL);if(b9){b9("");return}else{return""}}b8=parseInt(b8);if(typeof b9!="function"){b9=null}if(b8!=l&&b8!=V&&b8!=r&&b8!=Y&&b8!=bH){w(ae.INTERFACE_GETCERTTREE+ae.ERROR_INCORRECT_PARAM);if(b9){b9("");return}else{return""}}return bw(b8,ca,cb,cc,cd,b9)},setCert:function(cf,cd,b7,ch,cb,ce,b8,ca,cg,b9,cc){bs();if(!a5()){w(ae.INTERFACE_SETCERT+ae.ERROR_SETLICENSE_FAIL);if(cc){cc(-1);return}else{return-1}}if(typeof cc!="function"){cc=null}if(!ce){w(ae.INTERFACE_SETCERT+ae.ERROR_INCORRECT_PARAM);if(cc){cc(-1);return}else{return-1}}if(cf){if(!(typeof cf==="string"||typeof cf==="object")){w(ae.INTERFACE_SETCERT+ae.ERROR_INCORRECT_PARAM);if(cc){cc(-1);return}else{return-1}}return ay(cf,ce,b8,ca,cg,b9,cc)}else{if(cd&&b7){if(!(typeof cd==="string"||typeof cd==="object")){w(ae.INTERFACE_SETCERT+ae.ERROR_INCORRECT_PARAM);if(cc){cc(-1);return}else{return-1}}if(!(typeof b7==="string"||typeof b7==="object")){w(ae.INTERFACE_SETCERT+ae.ERROR_INCORRECT_PARAM);if(cc){cc(-1);return}else{return-1}}return b6(cd,b7,ch,cb,ce,b8,ca,cg,b9,cc)}else{w(ae.INTERFACE_SETCERT+ae.ERROR_INCORRECT_PARAM);if(cc){cc(-1);return}else{return-1}}}},getCert:function(b7,cb,b9,ca,b8){bs();if(!a5()){w(ae.INTERFACE_GETCERT+ae.ERROR_SETLICENSE_FAIL);if(b8){b8("");return}else{return""}}b7=parseInt(b7);if(typeof b8!="function"){b8=null}if(b7!=l&&b7!=V&&b7!=Y){w(ae.INTERFACE_GETCERT+ae.ERROR_INCORRECT_PARAM);if(b8){b8("");return}else{return""}}if((b7==V||b7==Y)&&(!cb||!b9)){w(ae.INTERFACE_GETCERT+ae.ERROR_INCORRECT_PARAM);if(b8){b8("");return}else{return""}}var cc=function(cd){if(b8){b8(cd)}else{return cd}};bW(b7,cb,b9,ca,cc)},importCert:function(ce,cb,b7,cg,b9,cf,cc,cd,b8,ca){bs();if(!a5()){w(ae.INTERFACE_IMPORTCERT+ae.ERROR_SETLICENSE_FAIL);if(ca){ca(-1);return}else{return-1}}cc=parseInt(cc);if(typeof ca!="function"){ca=null}if(cc!=l&&cc!=V&&cc!=Y){w(ae.INTERFACE_IMPORTCERT+ae.ERROR_INCORRECT_PARAM);if(ca){ca(-1);return}else{return-1}}if(!cf){w(ae.INTERFACE_IMPORTCERT+ae.ERROR_INCORRECT_PARAM);if(ca){ca(-1);return}else{return-1}}if(ce){if(!(typeof ce==="string"||typeof ce==="object")){w(ae.INTERFACE_IMPORTCERT+ae.ERROR_INCORRECT_PARAM);if(ca){ca(-1);return}else{return-1}}return aC(ce,cf,cc,cd,b8,ca)}else{if(cb&&b7){if(!(typeof cb==="string"||typeof cb==="object")){w(ae.INTERFACE_IMPORTCERT+ae.ERROR_INCORRECT_PARAM);if(ca){ca(-1);return}else{return-1}}if(!(typeof b7==="string"||typeof b7==="object")){w(ae.INTERFACE_IMPORTCERT+ae.ERROR_INCORRECT_PARAM);if(ca){ca(-1);return}else{return-1}}return a(cb,b7,cg,b9,cf,cc,cd,b8,ca)}else{w(ae.INTERFACE_IMPORTCERT+ae.ERROR_INCORRECT_PARAM);if(ca){ca(-1);return}else{return-1}}}},exportCert:function(b7,cb,b9,cd,cc,ca,b8){bs();if(!a5()){w(ae.INTERFACE_EXPORTCERT+ae.ERROR_SETLICENSE_FAIL);if(b8){b8("");return}else{return""}}b7=parseInt(b7);if(typeof b8!="function"){b8=null}if(b7!=l&&b7!=V&&b7!=Y){w(ae.INTERFACE_EXPORTCERT+ae.ERROR_INCORRECT_PARAM);if(b8){b8("");return}else{return""}}if(!cb||!b9||!cd){w(ae.INTERFACE_EXPORTCERT+ae.ERROR_INCORRECT_PARAM);if(b8){b8("");return}else{return""}}if((b7==l||b7==V)&&!cc){w(ae.INTERFACE_EXPORTCERT+ae.ERROR_INCORRECT_PARAM);if(b8){b8("");return}else{return""}}return b5(b7,cb,b9,cd,cc,ca,b8)},deleteCert:function(b8,b7,cc,ca,cb,b9){bs();if(!a5()){w(ae.INTERFACE_DELETECERT+ae.ERROR_SETLICENSE_FAIL);if(b9){b9(-1);return}else{return-1}}b8=parseInt(b8);if(typeof b9!="function"){b9=null}if(b8!=l&&b8!=V&&b8!=r&&b8!=Y){w(ae.INTERFACE_DELETECERT+ae.ERROR_INCORRECT_PARAM);if(b9){b9(-1);return}else{return-1}}if((b8==V||b8==Y||b8==r)&&(!cc||!ca)){w(ae.INTERFACE_DELETECERT+ae.ERROR_INCORRECT_PARAM);if(b9){b9(-1);return}else{return-1}}return ag(b8,cc,ca,b9)},checkPwd:function(ca,b8,b9,b7){bs();if(!a5()){w(ae.INTERFACE_CHECKPWD+ae.ERROR_SETLICENSE_FAIL);if(b7){b7(-1);return}else{return-1}}if(typeof b7!="function"){b7=null}if(!ca){w(ae.INTERFACE_CHECKPWD+ae.ERROR_INCORRECT_PARAM);if(b7){b7(-1);return}else{return-1}}var cb=t(ca,b8,b9);if(b7){b7(cb)}else{return cb}},verifyCertPwd:function(b7,cb,b9,cc,ca,b8){bs();if(!a5()){w(ae.INTERFACE_VERIFYCERTPWD+ae.ERROR_SETLICENSE_FAIL);if(b8){b8(-1);return}else{return-1}}b7=parseInt(b7);if(typeof b8!="function"){b8=null}if(b7!=l&&b7!=V&&b7!=r&&b7!=Y){w(ae.INTERFACE_VERIFYCERTPWD+ae.ERROR_INCORRECT_PARAM);if(b8){b8(-1);return}else{return-1}}if(b7==l&&!cc){w(ae.INTERFACE_VERIFYCERTPWD+ae.ERROR_INCORRECT_PARAM);if(b8){b8(-1);return}else{return-1}}if((b7==V||b7==Y)&&(!cb||!b9||!cc)){w(ae.INTERFACE_VERIFYCERTPWD+ae.ERROR_INCORRECT_PARAM);if(b8){b8(-1);return}else{return-1}}return a8(b7,cb,b9,cc,b8)},changeCertPwd:function(b7,cd,ca,b9,ce,cc,cb,b8){bs();if(!a5()){w(ae.INTERFACE_CHANGECERTPWD+ae.ERROR_SETLICENSE_FAIL);if(b8){b8(-1);return}else{return-1}}b7=parseInt(b7);if(typeof b8!="function"){b8=null}if(b7!=V&&b7!=r&&b7!=Y){w(ae.INTERFACE_CHANGECERTPWD+ae.ERROR_INCORRECT_PARAM);if(b8){b8(-1);return}else{return-1}}if(!cd||!ca||!b9||!ce){w(ae.INTERFACE_CHANGECERTPWD+ae.ERROR_INCORRECT_PARAM);if(b8){b8(-1);return}else{return-1}}return aS(b7,cd,ca,b9,ce,cc,b8)},verifyCert:function(b8,b7,cb,ca,cd,b9){bs();if(!a5()){w(ae.INTERFACE_VERIFYCERT+ae.ERROR_SETLICENSE_FAIL);if(b9){b9(-1);return}else{return-1}}b8=parseInt(b8);if(typeof b9!="function"){b9=null}if(b8!=l&&b8!=V&&b8!=Y){w(ae.INTERFACE_VERIFYCERT+ae.ERROR_INCORRECT_PARAM);if(b9){b9(-1);return}else{return-1}}if((b8==V||b8==Y)&&(!cb||!ca)){w(ae.INTERFACE_VERIFYCERT+ae.ERROR_INCORRECT_PARAM);if(b9){b9(-1);return}else{return-1}}var cc=function(ce){if(b9){b9(ce)}else{return ce}};return bc(b8,cb,ca,cd,cc)},verifyCertOwner:function(b7,cb,b9,cd,ce,ca,b8){bs();if(!a5()){w(ae.INTERFACE_VERIFYCERTOWNER+ae.ERROR_SETLICENSE_FAIL);if(b8){b8(-1);return}else{return-1}}b7=parseInt(b7);if(typeof b8!="function"){b8=null}if(b7!=l&&b7!=V&&b7!=Y){w(ae.INTERFACE_VERIFYCERTOWNER+ae.ERROR_INCORRECT_PARAM);if(b8){b8(-1);return}else{return-1}}if(b7==l&&!cd){w(ae.INTERFACE_VERIFYCERTOWNER+ae.ERROR_INCORRECT_PARAM);if(b8){b8(-1);return}else{return-1}}if((b7==V||b7==Y)&&(!cb||!b9||!cd)){w(ae.INTERFACE_VERIFYCERTOWNER+ae.ERROR_INCORRECT_PARAM);if(b8){b8(-1);return}else{return-1}}if(b7==Y&&an.signType!=k){w(ae.INTERFACE_VERIFYCERTOWNER+ae.ERROR_INCORRECT_PARAM);if(b8){b8(-1);return}else{return-1}}var cc=function(cf){if(b8){b8(cf)}else{return cf}};return a7(b7,cb,b9,cd,ce,cc)},signData:function(b7,cc,b9,cd,cb,ca,b8){bs();if(!a5()){w(ae.INTERFACE_SIGNDATA+ae.ERROR_SETLICENSE_FAIL);if(b8){b8("");return}else{return""}}b7=parseInt(b7);if(typeof b8!="function"){b8=null}if(b7!=l&&b7!=V&&b7!=r&&b7!=Y){w(ae.INTERFACE_SIGNDATA+ae.ERROR_INCORRECT_PARAM);if(b8){b8("");return}else{return""}}return aq(b7,cc,b9,cd,cb,ca,0,b8)},signDataUCPID:function(b7,cc,b9,ce,ca,cd,cb,b8){bs();if(!a5()){w(ae.INTERFACE_SIGNDATA_UCPID+ae.ERROR_SETLICENSE_FAIL);if(b8){b8("");return}else{return""}}b7=parseInt(b7);if(typeof b8!="function"){b8=null}if(b7!=l&&b7!=V&&b7!=r&&b7!=Y){w(ae.INTERFACE_SIGNDATA_UCPID+ae.ERROR_INCORRECT_PARAM);if(b8){b8("");return}else{return""}}return aq(b7,cc,b9,ce,ca,cb,2,b8,cd)},signDataAdd:function(b7,cb,b9,cd,cc,ca,b8){bs();if(!a5()){w(ae.INTERFACE_SIGNDATAADD+ae.ERROR_SETLICENSE_FAIL);if(b8){b8("");return}else{return""}}b7=parseInt(b7);if(typeof b8!="function"){b8=null}if(b7!=l&&b7!=V&&b7!=r&&b7!=Y){w(ae.INTERFACE_SIGNDATAADD+ae.ERROR_INCORRECT_PARAM);if(b8){b8("");return}else{return""}}if(b7==Y&&an.signType!=k){w(ae.INTERFACE_SIGNDATAADD+ae.ERROR_INCORRECT_PARAM);if(b8){b8("");return}else{return""}}return aq(b7,cb,b9,cd,cc,ca,1,b8)},signFileInfo:function(b7,cb,b9,cc,cd,ca,b8){bs();if(!a5()){w(ae.INTERFACE_SIGNDATA+ae.ERROR_SETLICENSE_FAIL);if(b8){b8("");return}else{return""}}b7=parseInt(b7);if(typeof b8!="function"){b8=null}if(b7!=l&&b7!=V&&b7!=r&&b7!=Y){w(ae.INTERFACE_SIGNDATA+ae.ERROR_INCORRECT_PARAM);if(b8){b8("");return}else{return""}}if(!(ca&512)){ca|=512}if(!(ca&2048)){ca|=2048}if(!(ca&4096)){ca|=4096}if(ca&32){return aq(b7,cb,b9,cc,cd,ca,1,b8)}else{return aq(b7,cb,b9,cc,cd,ca,0,b8)}},signFileInfoCacheCert:function(b7,cc,ca,b9,b8){bs();if(!a5()){w(ae.INTERFACE_SIGNDATA+ae.ERROR_SETLICENSE_FAIL);if(b8){b8("");return}else{return""}}b7=parseInt(b7);if(typeof b8!="function"){b8=null}if(b7!=l&&b7!=V&&b7!=r&&b7!=Y){w(ae.INTERFACE_SIGNDATA+ae.ERROR_INCORRECT_PARAM);if(b8){b8("");return}else{return""}}var cb={info:cc,hash:ca};if(!(b9&512)){b9|=512}if(!(b9&2048)){b9|=2048}if(!(b9&4096)){b9|=4096}return aq(b7,"","","",cb,b9,0,b8)},verifyData:function(ca,b9,b8,b7){bs();if(!a5()){w(ae.INTERFACE_VERIFYDATA+ae.ERROR_SETLICENSE_FAIL);if(b7){b7("");return}else{return""}}if(typeof b7!="function"){b7=null}if(!ca){w(ae.INTERFACE_VERIFYDATA+ae.ERROR_INCORRECT_PARAM);if(b7){b7("");return}else{return""}}var cb=bu(ca,b9,b8);if(b7){b7(cb)}else{return cb}},getSignedData:function(ca,b9,b8,b7){bs();if(!a5()){w(ae.INTERFACE_GETSIGNEDDATA+ae.ERROR_SETLICENSE_FAIL);if(b7){b7("");return}else{return""}}if(typeof b7!="function"){b7=null}if(!ca){w(ae.INTERFACE_GETSIGNEDDATA+ae.ERROR_INCORRECT_PARAM);if(b7){b7("");return}else{return""}}var cb=bq(ca,b9,b8);if(b7){b7(cb)}else{return cb}},envelopIdNum:function(cd,b8,ca,ce,b9,cb,b7,cc){bs();if(!a5()){w(ae.INTERFACE_ENVELOPIDNUM+ae.ERROR_SETLICENSE_FAIL);if(cc){cc("");return}else{return""}}cd=parseInt(cd);if(typeof cc!="function"){cc=null}if(cd!=l&&cd!=V&&cd!=Y){w(ae.INTERFACE_ENVELOPIDNUM+ae.ERROR_INCORRECT_PARAM);if(cc){cc("");return}else{return""}}if(cd==Y&&an.signType!=k){w(ae.INTERFACE_ENVELOPIDNUM+ae.ERROR_INCORRECT_PARAM);if(cc){cc("");return}else{return""}}if(!cb){w(ae.INTERFACE_ENVELOPIDNUM+ae.ERROR_INCORRECT_PARAM);if(cc){cc("");return}else{return""}}var cf=function(cg){if(cc){cc(cg)}else{return cg}};return a6(cd,b8,ca,ce,b9,cb,cf)},envelopeDataWithCert:function(b8,cd,cc,cb,b9,b7){bs();if(!a5()){w(ae.INTERFACE_ENVELOPEDATAWITHCERT+ae.ERROR_SETLICENSE_FAIL);if(b7){b7("");return}else{return""}}if(typeof b7!="function"){b7=null}b8=String(b8);if(b8=="undefined"||b8==""){w(ae.INTERFACE_ENVELOPEDATAWITHCERT+ae.ERROR_INCORRECT_PARAM);if(b7){b7("");return}else{return""}}var ca=function(ce){if(b7){b7(ce)}else{return ce}};return j(b8,cd,cc,cb,b9,ca)},envelopeDataWithPEM:function(b8,ca,b9,b7){bs();if(!a5()){w(ae.INTERFACE_ENVELOPEDATAWITHPEM+ae.ERROR_SETLICENSE_FAIL);if(b7){b7("");return}else{return""}}if(typeof b7!="function"){b7=null}if(!b8){w(ae.INTERFACE_ENVELOPEDATAWITHPEM+ae.ERROR_INCORRECT_PARAM);if(b7){b7("");return}else{return""}}var cb=bS(b8,ca,b9);if(b7){b7(cb)}else{return cb}},envelopeDataWithPwd:function(b7,ca,b9,b8){bs();if(!a5()){w(ae.INTERFACE_ENVELOPEDATAWITHPWD+ae.ERROR_SETLICENSE_FAIL);if(b8){b8("");return}else{return""}}if(typeof b8!="function"){b8=null}if(!b7){w(ae.INTERFACE_ENVELOPEDATAWITHPWD+ae.ERROR_INCORRECT_PARAM);if(b8){b8("");return}else{return""}}var cb=bI(b7,ca,b9);if(b8){b8(cb)}else{return cb}},deenvelopeDataWithCert:function(b7,cb,b9,cd,cc,ca,b8){bs();if(!a5()){w(ae.INTERFACE_DEENVELOPEDATAWITHCERT+ae.ERROR_SETLICENSE_FAIL);if(b8){b8("");return}else{return""}}b7=parseInt(b7);if(typeof b8!="function"){b8=null}if(b7!=l&&b7!=V&&b7!=Y){w(ae.INTERFACE_DEENVELOPEDATAWITHCERT+ae.ERROR_INCORRECT_PARAM);if(b8){b8("");return}else{return""}}if(b7==Y&&an.signType!=k){w(ae.INTERFACE_DEENVELOPEDATAWITHCERT+ae.ERROR_INCORRECT_PARAM);if(b8){b8("");return}else{return""}}if(!cc){w(ae.INTERFACE_DEENVELOPEDATAWITHCERT+ae.ERROR_INCORRECT_PARAM);if(b8){b8("");return}else{return""}}var ce=function(cf){if(b8){b8(cf)}else{return cf}};return bd(b7,cb,b9,cd,cc,ce)},deenvelopeDataWithPwd:function(b7,ca,b9,b8){bs();if(!a5()){w(ae.INTERFACE_DEENVELOPEDATAWITHPWD+ae.ERROR_SETLICENSE_FAIL);if(b8){b8("");return}else{return""}}if(typeof b8!="function"){b8=null}if(!ca||!b7){w(ae.INTERFACE_DEENVELOPEDATAWITHPWD+ae.ERROR_INCORRECT_PARAM);if(b8){b8("");return}else{return""}}var cb=N(b7,ca);if(b8){b8(cb)}else{return cb}},requestCert:function(ca,cb,cg,cf,cd,ce,b8,b9,b7,cc){bs();if(!a5()){w(ae.INTERFACE_REQUESTCERT+ae.ERROR_SETLICENSE_FAIL);if(cc){cc(-1);return}else{return-1}}cd=parseInt(cd);if(cd!=V&&cd!=r){w(ae.INTERFACE_REQUESTCERT+ae.ERROR_INCORRECT_PARAM);if(cc){cc(-1);return}else{return-1}}if((cd==V||cd==r)&&(!ca||!cb||!cg||!cf||!ce||!b9)){w(ae.INTERFACE_REQUESTCERT+ae.ERROR_INCORRECT_PARAM);if(cc){cc(-1);return}else{return-1}}bA(ca,cb,cg,cf,cd,ce,b8,b9,b7,cc)},renewCert:function(cd,cf,ch,cb,ce,b7,b8,b9,cc,ca,cg){bs();if(!a5()){w(ae.INTERFACE_RENEWCERT+ae.ERROR_SETLICENSE_FAIL);if(cg){cg(-1);return}else{return-1}}ch=parseInt(ch);if(ch!=V&&ch!=r){w(ae.INTERFACE_RENEWCERT+ae.ERROR_INCORRECT_PARAM);if(cg){cg(-1);return}else{return-1}}if((ch==V||ch==r)&&(!cd||!cf||!cb||!ce||!b7||!b8||!cc)){w(ae.INTERFACE_RENEWCERT+ae.ERROR_INCORRECT_PARAM);if(cg){cg(-1);return}else{return-1}}aK(cd,cf,ch,cb,ce,b7,b8,b9,cc,ca,cg)},revokeCert:function(){return},hashData:function(cb,b9,b8,b7){bs();cb=parseInt(cb);if(typeof b7!="function"){b7=null}var ca=f(cb,b9,b8);if(b7){b7(ca)}else{return ca}},SyncOpenCert:function(ca,b8,b9,b7){bs();if(!a5()){a9(ae.INTERFACE_SYNCOPENCERT);if(b7){b7(-1);return}else{return-1}}if(aI==false){w(ae.INTERFACE_SYNCOPENCERT);if(b7){b7(-1);return}else{return-1}}D(ca,b8,b9,b7)},SetCloudTrayView:function(b7){bb(b7)},exportCertRelayFromBrowser:function(ca,ce,b7,b9,cc,cb,cd,b8){bs();if(!bi()){w(ae.INTERFACE_ANYCERTRELAY_EXPORT+ae.ERROR_SETLICENSE_FAIL);if(b8){b8(-1);return}else{return-1}}az(ca,ce,b7,b9,cc,cb,cd,b8)},importCertRelayToBrowser:function(b8,ca,b9,b7){bs();if(!bi()){w(ae.INTERFACE_ANYCERTRELAY_IMPORT+ae.ERROR_SETLICENSE_FAIL);if(b7){b7(-1);return}else{return-1}}R(b8,ca,b9,b7)},registerAuthCodeForImportCertRelay:function(b8,ca,b9,b7){bs();if(!bi()){w(ae.INTERFACE_ANYCERTRELAY_IMPORT+ae.ERROR_SETLICENSE_FAIL);if(b7){b7(-1);return}else{return-1}}ah(b8,ca,b9,b7)},xfsInit:function(ce,cd,b9,b8,cc,b7,cb,ca){aT(ce,cd,b9,b8,cc,b7,cb,ca)},xfsLogin:function(b8,cb,ca,b9,b7){bs();if(!a5()){w(ae.INTERFACE_XFSLOGIN+ae.ERROR_SETLICENSE_FAIL);if(b7){b7(-1);return}else{return-1}}if(typeof b7!="function"){b7=null}if(!b8||!cb){w(ae.INTERFACE_XFSLOGIN+ae.ERROR_INCORRECT_PARAM);if(b7){b7(-1);return}else{return-1}}al(b8,cb,ca,b9,b7)},xfsOtpRequest:function(b8,b7){bs();if(!a5()){w(ae.INTERFACE_XFSOTPREQUEST+ae.ERROR_SETLICENSE_FAIL);if(b7){b7(-1);return}else{return-1}}if(typeof b7!="function"){b7=null}if(!b8){w(ae.INTERFACE_XFSOTPREQUEST+ae.ERROR_INCORRECT_PARAM);if(b7){b7(-1);return}else{return-1}}bj(b8,b7)},xfsLogout:function(b7){bs();if(!a5()){w(ae.INTERFACE_XFSLOGOUT+ae.ERROR_SETLICENSE_FAIL);if(b7){b7(-1);return}else{return-1}}if(typeof b7!="function"){b7=null}bk(b7)},apnInitialize:function(cc,cb,b9,ca,b8,b7){bC(cc,cb,b9,ca,b8,b7)},apnGetPinIDList:function(b8,ca,b9,b7){bs();if(!bh()){w(ae.INTERFACE_ANYPIN_GETPINIDLIST+ae.ERROR_SETLICENSE_FAIL);if(b7){b7("");return}else{return""}}if(typeof b7!="function"){b7=null}return bt(b8,ca,b9,b7)},apnUpdatePinLastTime:function(b8,b7){bs();if(!bh()){w(ae.INTERFACE_ANYPIN_UPDATEPINLASTTIME+ae.ERROR_SETLICENSE_FAIL);if(b7){b7(-1);return}else{return-1}}if(typeof b7!="function"){b7=null}return bE(b8,b7)},apnCheckPin:function(cb,ca,b7,cd,b9,b8){bs();if(!bh()){w(ae.INTERFACE_ANYPIN_CHECKPIN+ae.ERROR_SETLICENSE_FAIL);if(b8){b8(-1);return}else{return-1}}b7=parseInt(b7);cd=parseInt(cd);if(typeof b8!="function"){b8=null}if(!cb){w(ae.INTERFACE_ANYPIN_CHECKPIN+ae.ERROR_INCORRECT_PARAM);if(b8){b8(-1);return}else{return-1}}if(!b7||b7<0||!cd||cd<0){w(ae.INTERFACE_ANYPIN_CHECKPIN+ae.ERROR_INCORRECT_PARAM);if(b8){b8(-1);return}else{return-1}}var cc=bv(cb,ca,b7,cd,b9);if(b8){b8(cc)}else{return cc}},apnInitPin:function(b9,b8,b7){bs();if(!bh()){w(ae.INTERFACE_ANYPIN_INITPIN+ae.ERROR_SETLICENSE_FAIL);if(b7){b7("");return}else{return""}}return aJ(b9,b8,b7)},apnInitRegist:function(b9,b8,b7){bs();if(!bh()){w(ae.INTERFACE_ANYPIN_INITREGIST+ae.ERROR_SETLICENSE_FAIL);if(b7){b7("");return}else{return""}}return bf(b9,b8,b7)},apnRegistPin:function(b9,b7,ce,cc,cf,cd,b8,ca,cb){bs();if(!bh()){w(ae.INTERFACE_ANYPIN_REGISTPIN+ae.ERROR_SETLICENSE_FAIL);if(cb){cb(-1);return}else{return-1}}return bX(b9,b7,ce,cc,cf,cd,b8,ca,cb)},apnInitSession:function(b9,b8,b7){bs();if(!bh()){w(ae.INTERFACE_ANYPIN_INITSESSION+ae.ERROR_SETLICENSE_FAIL);if(b7){b7("");return}else{return""}}return bZ(b9,b8,b7)},apnSetNoDueDay:function(b9,b8,b7){bs();if(!bh()){w(ae.INTERFACE_ANYPIN_SETNODUEDAY+ae.ERROR_SETLICENSE_FAIL);if(b7){b7(-1);return}else{return-1}}return S(b9,b8,b7)},apnAuthSession:function(ce,cc,b9,cb,b8,cd,ca,b7){bs();if(!bh()){w(ae.INTERFACE_ANYPIN_AUTHSESSION+ae.ERROR_SETLICENSE_FAIL);if(b7){b7("");return}else{return""}}return d(ce,cc,b9,cb,b8,cd,ca,b7)},apnEndSession:function(b8,b7){bs();if(!bh()){w(ae.INTERFACE_ANYPIN_ENDSESSION+ae.ERROR_SETLICENSE_FAIL);if(b7){b7(-1);return}else{return-1}}return ad(b8,b7)},apnSignPin:function(cb,ca,b9,b8,b7){bs();if(!bh()){w(ae.INTERFACE_ANYPIN_SIGNPIN+ae.ERROR_SETLICENSE_FAIL);if(b7){b7("");return}else{return""}}return P(cb,ca,b9,b8,b7)},apnDeletePin:function(b9,b8,b7){bs();if(!bh()){w(ae.INTERFACE_ANYPIN_DELETEPIN+ae.ERROR_SETLICENSE_FAIL);if(b7){b7(-1);return}else{return-1}}return bo(b9,b8,b7)},apnDeleteAllPin:function(b9,b8,b7){bs();if(!bh()){w(ae.INTERFACE_ANYPIN_DELETEALLPIN+ae.ERROR_SETLICENSE_FAIL);if(b7){b7(-1);return}else{return-1}}return O(b9,b8,b7)},apnDeletePinLocal:function(b9,b8,b7){bs();if(!bh()){w(ae.INTERFACE_ANYPIN_DELETEPIN+ae.ERROR_SETLICENSE_FAIL);if(b7){b7(-1);return}else{return-1}}return bl(b9,b8,b7)},apnChangePin:function(cb,b9,ca,b8,b7){bs();if(!bh()){w(ae.INTERFACE_ANYPIN_CHANGEPIN+ae.ERROR_SETLICENSE_FAIL);if(b7){b7(-1);return}else{return-1}}return aO(cb,b9,ca,b8,b7)},apnReadDeviceInfoList:function(cb,ca,b9,b8,b7){bs();if(!bh()){w(ae.INTERFACE_ANYPIN_READDEVICEINFOLIST+ae.ERROR_SETLICENSE_FAIL);if(b7){b7(-1);return}else{return-1}}return z(cb,ca,b9,b8,b7)},apnReadDeviceInfo:function(ca,b9,b8,b7){bs();if(!bh()){w(ae.INTERFACE_ANYPIN_READDEVICEINFO+ae.ERROR_SETLICENSE_FAIL);if(b7){b7(-1);return}else{return-1}}return bD(ca,b9,b8,b7)},apnDeleteDevice:function(ca,b9,b8,b7){bs();if(!bh()){w(ae.INTERFACE_ANYPIN_DELETEDEVICE+ae.ERROR_SETLICENSE_FAIL);if(b7){b7(-1);return}else{return-1}}return bV(ca,b9,b8,b7)},apnDeleteAllDevice:function(b9,b8,b7){bs();if(!bh()){w(ae.INTERFACE_ANYPIN_DELETEALLDEVICE+ae.ERROR_SETLICENSE_FAIL);if(b7){b7(-1);return}else{return-1}}return ab(b9,b8,b7)},apnReadAuditInfoList:function(b9,cg,cc,cd,ca,ce,b7,cb,b8,cf){bs();if(!bh()){w(ae.INTERFACE_ANYPIN_READAUDITINFOLIST+ae.ERROR_SETLICENSE_FAIL);if(cf){cf(-1);return}else{return-1}}return aQ(b9,cg,cc,cd,ca,ce,b7,cb,b8,cf)},apnReadAuditInfo:function(ca,b7,b9,b8){bs();if(!bh()){w(ae.INTERFACE_ANYPIN_READAUDITINFO+ae.ERROR_SETLICENSE_FAIL);if(b8){b8(-1);return}else{return-1}}return g(ca,b7,b9,b8)}}}();