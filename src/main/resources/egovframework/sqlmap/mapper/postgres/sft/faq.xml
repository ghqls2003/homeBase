<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="sft.faq">

    <!-- 공지사항 리스트 -->
	<select id="FAQList" resultType="map">
		SELECT T.* FROM (
		SELECT
			row_number() over(ORDER BY pst_sn desc) as rn
			, pst_sn
			, pst_ttl
			, pst_cn
			, dcmf.atch_file_nm
			, to_char(reg_dt, 'yyyy-mm-dd') as reg_dt
			, atch_file_sn
			, (select cd_nm from dvs_cmm_mt_code dcmc where cd_group = 'faq_type_cd' and cd = pst_type_cd)
		FROM dvs_cmm_mt_post dcmp
		left join (
			SELECT
				file_sn
				, atch_file_nm
			FROM dqvs.dvs_cmm_mt_file ) dcmf
			ON dcmp.atch_file_sn = dcmf.file_sn
		where menu_cd = 'BBST03'
		and use_yn = 'Y'
		<if test='searchWrd != null and searchWrd != ""'>
			and pst_ttl like '%' || #{searchWrd} || '%'
		</if>
		) T
		WHERE
			<if test="take != '' and take != null">
				T.rn <![CDATA[<=]]> (CAST(#{take} AS INTEGER) + CAST(#{skip} AS INTEGER))
			</if>
			<if test="skip != '' and skip != null">
				AND T.rn <![CDATA[>]]> CAST(#{skip} AS INTEGER)
			</if>
		ORDER BY T.rn ASC
	</select>

	<select id="FAQListCnt" resultType="int">
		select count(*) from (SELECT T.* FROM (
		SELECT
			row_number() over(ORDER BY pst_sn ASC) as rn
			, pst_sn
			, pst_ttl
			, pst_cn
			, to_char(reg_dt, 'yyyy-mm-dd') as reg_dt
			, atch_file_sn
			, (select cd_nm from dvs_cmm_mt_code dcmc where cd_group = 'faq_type_cd' and cd = pst_type_cd)
		FROM dvs_cmm_mt_post
		where menu_cd = 'BBST03'
		and use_yn = 'Y'
		<if test='searchWrd != null and searchWrd != ""'>
			and pst_ttl like '%' || #{searchWrd} || '%'
		</if>
		) T) T
	</select>

</mapper>